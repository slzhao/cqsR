<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>limma Test and Design â€¢ cqsR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="limma Test and Design">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">cqsR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/limmaTestAndDesign.html">limma Test and Design</a>
    </li>
    <li>
      <a href="../articles/matchVcfToGr.html">Untitled</a>
    </li>
    <li>
      <a href="../articles/reportExample.html">Report Title</a>
    </li>
    <li>
      <a href="../articles/RforDataScienceNotes.html">R for Data Science Notes</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>limma Test and Design</h1>
            
      
      
      <div class="hidden name"><code>limmaTestAndDesign.Rmd</code></div>

    </div>

    
    
<p><a href="https://www.bioconductor.org/packages/release/bioc/vignettes/limma/inst/doc/usersguide.pdf" class="uri">https://www.bioconductor.org/packages/release/bioc/vignettes/limma/inst/doc/usersguide.pdf</a></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(limma)</a></code></pre></div>
<div id="makedesign-and-contrast-in-one-factor-two-methods" class="section level1">
<h1 class="hasAnchor">
<a href="#makedesign-and-contrast-in-one-factor-two-methods" class="anchor"></a>MakeDesign and Contrast in One Factor: Two methods</h1>
<p>Method 1</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="co">#####################################</span></a>
<a class="sourceLine" id="cb2-2" title="2"><span class="co"># Two groups</span></a>
<a class="sourceLine" id="cb2-3" title="3"><span class="co">#####################################</span></a>
<a class="sourceLine" id="cb2-4" title="4"></a>
<a class="sourceLine" id="cb2-5" title="5">design &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/cbind">cbind</a></span>(<span class="dt">WT =</span> <span class="dv">1</span>, <span class="dt">MUvsWT =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb2-6" title="6">design</a></code></pre></div>
<pre><code>##      WT MUvsWT
## [1,]  1      0
## [2,]  1      0
## [3,]  1      1
## [4,]  1      1
## [5,]  1      1</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="co"># Or by</span></a>
<a class="sourceLine" id="cb4-2" title="2">Group &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">factor</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb4-3" title="3">design &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/model.matrix">model.matrix</a></span>(<span class="op">~</span>Group)</a>
<a class="sourceLine" id="cb4-4" title="4"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/colnames">colnames</a></span>(design) &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"WT"</span>, <span class="st">"MUvsWT"</span>)</a>
<a class="sourceLine" id="cb4-5" title="5">design</a></code></pre></div>
<pre><code>##   WT MUvsWT
## 1  1      0
## 2  1      0
## 3  1      1
## 4  1      1
## 5  1      1
## attr(,"assign")
## [1] 0 1
## attr(,"contrasts")
## attr(,"contrasts")$Group
## [1] "contr.treatment"</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="co"># fit &lt;- lmFit(eset, design)</span></a>
<a class="sourceLine" id="cb6-2" title="2"><span class="co"># fit &lt;- eBayes(fit)</span></a>
<a class="sourceLine" id="cb6-3" title="3"><span class="co"># topTable(fit, coef="MUvsWT", adjust="BH")</span></a></code></pre></div>
<p>Method 2</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="co">#####################################</span></a>
<a class="sourceLine" id="cb7-2" title="2"><span class="co"># Two groups</span></a>
<a class="sourceLine" id="cb7-3" title="3"><span class="co">#####################################</span></a>
<a class="sourceLine" id="cb7-4" title="4"></a>
<a class="sourceLine" id="cb7-5" title="5">design &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/cbind">cbind</a></span>(<span class="dt">WT =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="dt">MU =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb7-6" title="6">design</a></code></pre></div>
<pre><code>##      WT MU
## [1,]  1  0
## [2,]  1  0
## [3,]  0  1
## [4,]  0  1
## [5,]  0  1</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1"><span class="co"># Or By</span></a>
<a class="sourceLine" id="cb9-2" title="2">design &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/model.matrix">model.matrix</a></span>(<span class="op">~</span><span class="st"> </span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span>Group)</a>
<a class="sourceLine" id="cb9-3" title="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/colnames">colnames</a></span>(design) &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"WT"</span>, <span class="st">"MU"</span>)</a>
<a class="sourceLine" id="cb9-4" title="4">design</a></code></pre></div>
<pre><code>##   WT MU
## 1  1  0
## 2  1  0
## 3  0  1
## 4  0  1
## 5  0  1
## attr(,"assign")
## [1] 1 1
## attr(,"contrasts")
## attr(,"contrasts")$Group
## [1] "contr.treatment"</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1">cont.matrix &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/makeContrasts">makeContrasts</a></span>(<span class="dt">MUvsWT =</span> MU <span class="op">-</span><span class="st"> </span>WT, <span class="dt">levels =</span> design)</a>
<a class="sourceLine" id="cb11-2" title="2">cont.matrix</a></code></pre></div>
<pre><code>##       Contrasts
## Levels MUvsWT
##     WT     -1
##     MU      1</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1"><span class="co"># fit &lt;- lmFit(eset, design)</span></a>
<a class="sourceLine" id="cb13-2" title="2"><span class="co"># fit2 &lt;- contrasts.fit(fit, cont.matrix)</span></a>
<a class="sourceLine" id="cb13-3" title="3"><span class="co"># fit2 &lt;- eBayes(fit2)</span></a>
<a class="sourceLine" id="cb13-4" title="4"><span class="co"># topTable(fit2, adjust="BH")</span></a>
<a class="sourceLine" id="cb13-5" title="5"></a>
<a class="sourceLine" id="cb13-6" title="6"><span class="co">#####################################</span></a>
<a class="sourceLine" id="cb13-7" title="7"><span class="co"># Three groups</span></a>
<a class="sourceLine" id="cb13-8" title="8"><span class="co">#####################################</span></a>
<a class="sourceLine" id="cb13-9" title="9"></a>
<a class="sourceLine" id="cb13-10" title="10">targets &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"RNA1"</span>, <span class="st">"RNA1"</span>, <span class="st">"RNA2"</span>, <span class="st">"RNA2"</span>, <span class="st">"RNA3"</span>, <span class="st">"RNA3"</span>)</a>
<a class="sourceLine" id="cb13-11" title="11">f &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">factor</a></span>(targets, <span class="dt">levels =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"RNA1"</span>, <span class="st">"RNA2"</span>, <span class="st">"RNA3"</span>))</a>
<a class="sourceLine" id="cb13-12" title="12">design &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/model.matrix">model.matrix</a></span>(<span class="op">~</span><span class="st"> </span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span>f)</a>
<a class="sourceLine" id="cb13-13" title="13"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/colnames">colnames</a></span>(design) &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"RNA1"</span>, <span class="st">"RNA2"</span>, <span class="st">"RNA3"</span>)</a>
<a class="sourceLine" id="cb13-14" title="14">design</a></code></pre></div>
<pre><code>##   RNA1 RNA2 RNA3
## 1    1    0    0
## 2    1    0    0
## 3    0    1    0
## 4    0    1    0
## 5    0    0    1
## 6    0    0    1
## attr(,"assign")
## [1] 1 1 1
## attr(,"contrasts")
## attr(,"contrasts")$f
## [1] "contr.treatment"</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1">contrast.matrix &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/makeContrasts">makeContrasts</a></span>(RNA2 <span class="op">-</span><span class="st"> </span>RNA1, RNA3 <span class="op">-</span><span class="st"> </span>RNA2, RNA3 <span class="op">-</span><span class="st"> </span>RNA1, <span class="dt">levels =</span> design)</a>
<a class="sourceLine" id="cb15-2" title="2">contrast.matrix</a></code></pre></div>
<pre><code>##       Contrasts
## Levels RNA2 - RNA1 RNA3 - RNA2 RNA3 - RNA1
##   RNA1          -1           0          -1
##   RNA2           1          -1           0
##   RNA3           0           1           1</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1"><span class="co"># fit &lt;- lmFit(eset, design)</span></a>
<a class="sourceLine" id="cb17-2" title="2"><span class="co"># fit2 &lt;- contrasts.fit(fit, contrast.matrix)</span></a>
<a class="sourceLine" id="cb17-3" title="3"><span class="co"># fit2 &lt;- eBayes(fit2)</span></a>
<a class="sourceLine" id="cb17-4" title="4"><span class="co"># topTable(fit2, coef=1, adjust="BH")</span></a></code></pre></div>
</div>
<div id="examples-with-data" class="section level1">
<h1 class="hasAnchor">
<a href="#examples-with-data" class="anchor"></a>Examples with Data</h1>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1">sd &lt;-<span class="st"> </span><span class="fl">0.3</span> <span class="op">*</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/MathFun">sqrt</a></span>(<span class="dv">4</span> <span class="op">/</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Chisquare">rchisq</a></span>(<span class="dv">100</span>, <span class="dt">df =</span> <span class="dv">4</span>))</a>
<a class="sourceLine" id="cb18-2" title="2">y &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/matrix">matrix</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Normal">rnorm</a></span>(<span class="dv">100</span> <span class="op">*</span><span class="st"> </span><span class="dv">10</span>, <span class="dt">sd =</span> sd), <span class="dv">100</span>, <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb18-3" title="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/colnames">rownames</a></span>(y) &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"Gene"</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">100</span>)</a>
<a class="sourceLine" id="cb18-4" title="4">y[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dv">4</span><span class="op">:</span><span class="dv">6</span>] &lt;-<span class="st"> </span>y[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dv">4</span><span class="op">:</span><span class="dv">6</span>] <span class="op">+</span><span class="st"> </span><span class="dv">2</span></a></code></pre></div>
<div id="one-factor-three-groups" class="section level2">
<h2 class="hasAnchor">
<a href="#one-factor-three-groups" class="anchor"></a>One Factor: Three Groups</h2>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1"><span class="co"># Method 1</span></a>
<a class="sourceLine" id="cb19-2" title="2">Treat &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">factor</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"C"</span>, <span class="st">"C"</span>, <span class="st">"C"</span>, <span class="st">"T"</span>, <span class="st">"T"</span>, <span class="st">"T"</span>, <span class="st">"G"</span>, <span class="st">"G"</span>, <span class="st">"G"</span>, <span class="st">"G"</span>), <span class="dt">levels =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"C"</span>, <span class="st">"T"</span>, <span class="st">"G"</span>))</a>
<a class="sourceLine" id="cb19-3" title="3">design &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/model.matrix">model.matrix</a></span>(<span class="op">~</span>Treat)</a>
<a class="sourceLine" id="cb19-4" title="4">design</a></code></pre></div>
<pre><code>##    (Intercept) TreatT TreatG
## 1            1      0      0
## 2            1      0      0
## 3            1      0      0
## 4            1      1      0
## 5            1      1      0
## 6            1      1      0
## 7            1      0      1
## 8            1      0      1
## 9            1      0      1
## 10           1      0      1
## attr(,"assign")
## [1] 0 1 1
## attr(,"contrasts")
## attr(,"contrasts")$Treat
## [1] "contr.treatment"</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1">fit &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/lmFit">lmFit</a></span>(y, design)</a>
<a class="sourceLine" id="cb21-2" title="2">fit &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/ebayes">eBayes</a></span>(fit)</a>
<a class="sourceLine" id="cb21-3" title="3">TreatThreeT1 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/toptable">topTable</a></span>(fit, <span class="dt">coef =</span> <span class="st">"TreatT"</span>)</a>
<a class="sourceLine" id="cb21-4" title="4">TreatThreeG1 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/toptable">topTable</a></span>(fit, <span class="dt">coef =</span> <span class="st">"TreatG"</span>)</a>
<a class="sourceLine" id="cb21-5" title="5">contrast.matrix &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/makeContrasts">makeContrasts</a></span>(<span class="dt">TreatGT =</span> TreatG <span class="op">-</span><span class="st"> </span>TreatT, <span class="dt">levels =</span> design)</a></code></pre></div>
<pre><code>## Warning in makeContrasts(TreatGT = TreatG - TreatT, levels = design):
## Renaming (Intercept) to Intercept</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1">fit2 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/contrasts.fit">contrasts.fit</a></span>(fit, contrast.matrix)</a></code></pre></div>
<pre><code>## Warning in contrasts.fit(fit, contrast.matrix): row names of contrasts
## don't match col names of coefficients</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1">fit2 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/ebayes">eBayes</a></span>(fit2)</a>
<a class="sourceLine" id="cb25-2" title="2">TreatThreeGT1 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/toptable">topTable</a></span>(fit2, <span class="dt">coef =</span> <span class="st">"TreatGT"</span>)</a>
<a class="sourceLine" id="cb25-3" title="3"></a>
<a class="sourceLine" id="cb25-4" title="4"><span class="co"># Method 2</span></a>
<a class="sourceLine" id="cb25-5" title="5">design &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/model.matrix">model.matrix</a></span>(<span class="op">~</span><span class="st"> </span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span>Treat)</a>
<a class="sourceLine" id="cb25-6" title="6">design</a></code></pre></div>
<pre><code>##    TreatC TreatT TreatG
## 1       1      0      0
## 2       1      0      0
## 3       1      0      0
## 4       0      1      0
## 5       0      1      0
## 6       0      1      0
## 7       0      0      1
## 8       0      0      1
## 9       0      0      1
## 10      0      0      1
## attr(,"assign")
## [1] 1 1 1
## attr(,"contrasts")
## attr(,"contrasts")$Treat
## [1] "contr.treatment"</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" title="1">fit &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/lmFit">lmFit</a></span>(y, design)</a>
<a class="sourceLine" id="cb27-2" title="2">contrast.matrix &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/makeContrasts">makeContrasts</a></span>(<span class="dt">TreatTC =</span> TreatT <span class="op">-</span><span class="st"> </span>TreatC, <span class="dt">TreatGC =</span> TreatG <span class="op">-</span><span class="st"> </span>TreatC, <span class="dt">TreatGT =</span> TreatG <span class="op">-</span><span class="st"> </span>TreatT, <span class="dt">levels =</span> design)</a>
<a class="sourceLine" id="cb27-3" title="3">fit2 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/contrasts.fit">contrasts.fit</a></span>(fit, contrast.matrix)</a>
<a class="sourceLine" id="cb27-4" title="4">fit2 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/ebayes">eBayes</a></span>(fit2)</a>
<a class="sourceLine" id="cb27-5" title="5">TreatThreeT2 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/toptable">topTable</a></span>(fit2, <span class="dt">coef =</span> <span class="st">"TreatTC"</span>)</a>
<a class="sourceLine" id="cb27-6" title="6">TreatThreeG2 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/toptable">topTable</a></span>(fit2, <span class="dt">coef =</span> <span class="st">"TreatGC"</span>)</a>
<a class="sourceLine" id="cb27-7" title="7">TreatThreeGT2 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/toptable">topTable</a></span>(fit2, <span class="dt">coef =</span> <span class="st">"TreatGT"</span>)</a>
<a class="sourceLine" id="cb27-8" title="8"></a>
<a class="sourceLine" id="cb27-9" title="9"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/all.equal">all.equal</a></span>(TreatThreeT1, TreatThreeT2) <span class="co"># TRUE</span></a></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/all.equal">all.equal</a></span>(TreatThreeG1, TreatThreeG2) <span class="co"># TRUE</span></a></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/all.equal">all.equal</a></span>(TreatThreeGT1, TreatThreeGT2) <span class="co"># TRUE</span></a></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>
<div id="one-factor-three-groups-each-group-compare-with-rest" class="section level2">
<h2 class="hasAnchor">
<a href="#one-factor-three-groups-each-group-compare-with-rest" class="anchor"></a>One Factor: Three Groups, each group compare with rest</h2>
<p>Using design factor and contrast (1) A vs Other; (2) A vs (B+C)/2 are different. Method (2) is recommanded in most case as (1) used variation of all samples in Other group while (2) used the intra-group correlation for each individual group for the SEM.<br>
See <a href="https://support.bioconductor.org/p/26251/" class="uri">https://support.bioconductor.org/p/26251/</a> for more details</p>
</div>
<div id="other-tests" class="section level2">
<h2 class="hasAnchor">
<a href="#other-tests" class="anchor"></a>Other tests</h2>
<div id="samples-in-design-matrix-but-not-in-compasion" class="section level3">
<h3 class="hasAnchor">
<a href="#samples-in-design-matrix-but-not-in-compasion" class="anchor"></a>Samples in design matrix but not in compasion</h3>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" title="1">Treat &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">factor</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"C"</span>, <span class="st">"C"</span>, <span class="st">"C"</span>, <span class="st">"T"</span>, <span class="st">"T"</span>, <span class="st">"T"</span>, <span class="st">"G"</span>, <span class="st">"G"</span>, <span class="st">"G"</span>, <span class="st">"G"</span>), <span class="dt">levels =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"C"</span>, <span class="st">"T"</span>, <span class="st">"G"</span>))</a>
<a class="sourceLine" id="cb33-2" title="2">design &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/model.matrix">model.matrix</a></span>(<span class="op">~</span>Treat)</a>
<a class="sourceLine" id="cb33-3" title="3">design</a></code></pre></div>
<pre><code>##    (Intercept) TreatT TreatG
## 1            1      0      0
## 2            1      0      0
## 3            1      0      0
## 4            1      1      0
## 5            1      1      0
## 6            1      1      0
## 7            1      0      1
## 8            1      0      1
## 9            1      0      1
## 10           1      0      1
## attr(,"assign")
## [1] 0 1 1
## attr(,"contrasts")
## attr(,"contrasts")$Treat
## [1] "contr.treatment"</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" title="1">fit &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/lmFit">lmFit</a></span>(y, design)</a>
<a class="sourceLine" id="cb35-2" title="2">fit &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/ebayes">eBayes</a></span>(fit)</a>
<a class="sourceLine" id="cb35-3" title="3">contrast.matrix &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/makeContrasts">makeContrasts</a></span>(<span class="dt">TreatGT =</span> TreatG <span class="op">-</span><span class="st"> </span>TreatT, <span class="dt">levels =</span> design)</a></code></pre></div>
<pre><code>## Warning in makeContrasts(TreatGT = TreatG - TreatT, levels = design):
## Renaming (Intercept) to Intercept</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" title="1">fit2 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/contrasts.fit">contrasts.fit</a></span>(fit, contrast.matrix)</a></code></pre></div>
<pre><code>## Warning in contrasts.fit(fit, contrast.matrix): row names of contrasts
## don't match col names of coefficients</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" title="1">fit2 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/ebayes">eBayes</a></span>(fit2)</a>
<a class="sourceLine" id="cb39-2" title="2">TreatThreeGT1 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/toptable">topTable</a></span>(fit2, <span class="dt">coef =</span> <span class="st">"TreatGT"</span>)</a>
<a class="sourceLine" id="cb39-3" title="3"></a>
<a class="sourceLine" id="cb39-4" title="4">ySub=y[,<span class="op">-</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>)]</a>
<a class="sourceLine" id="cb39-5" title="5">Treat &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">factor</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"C"</span>, <span class="st">"C"</span>, <span class="st">"T"</span>, <span class="st">"T"</span>, <span class="st">"T"</span>, <span class="st">"G"</span>, <span class="st">"G"</span>, <span class="st">"G"</span>, <span class="st">"G"</span>), <span class="dt">levels =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"C"</span>, <span class="st">"T"</span>, <span class="st">"G"</span>))</a>
<a class="sourceLine" id="cb39-6" title="6">design &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/model.matrix">model.matrix</a></span>(<span class="op">~</span>Treat)</a>
<a class="sourceLine" id="cb39-7" title="7">design</a></code></pre></div>
<pre><code>##   (Intercept) TreatT TreatG
## 1           1      0      0
## 2           1      0      0
## 3           1      1      0
## 4           1      1      0
## 5           1      1      0
## 6           1      0      1
## 7           1      0      1
## 8           1      0      1
## 9           1      0      1
## attr(,"assign")
## [1] 0 1 1
## attr(,"contrasts")
## attr(,"contrasts")$Treat
## [1] "contr.treatment"</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" title="1">fit &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/lmFit">lmFit</a></span>(ySub, design)</a>
<a class="sourceLine" id="cb41-2" title="2">fit &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/ebayes">eBayes</a></span>(fit)</a>
<a class="sourceLine" id="cb41-3" title="3">contrast.matrix &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/makeContrasts">makeContrasts</a></span>(<span class="dt">TreatGT =</span> TreatG <span class="op">-</span><span class="st"> </span>TreatT, <span class="dt">levels =</span> design)</a></code></pre></div>
<pre><code>## Warning in makeContrasts(TreatGT = TreatG - TreatT, levels = design):
## Renaming (Intercept) to Intercept</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" title="1">fit2 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/contrasts.fit">contrasts.fit</a></span>(fit, contrast.matrix)</a></code></pre></div>
<pre><code>## Warning in contrasts.fit(fit, contrast.matrix): row names of contrasts
## don't match col names of coefficients</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" title="1">fit2 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/ebayes">eBayes</a></span>(fit2)</a>
<a class="sourceLine" id="cb45-2" title="2">TreatThreeGT2 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/toptable">topTable</a></span>(fit2, <span class="dt">coef =</span> <span class="st">"TreatGT"</span>)</a>
<a class="sourceLine" id="cb45-3" title="3"></a>
<a class="sourceLine" id="cb45-4" title="4"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/all.equal">all.equal</a></span>(TreatThreeGT1, TreatThreeGT2) <span class="co"># FALSE</span></a></code></pre></div>
<pre><code>## [1] "Attributes: &lt; Component \"row.names\": 5 string mismatches &gt;"
## [2] "Component \"logFC\": Mean relative difference: 0.4962263"    
## [3] "Component \"AveExpr\": Mean relative difference: 0.4828239"  
## [4] "Component \"t\": Mean relative difference: 0.5365064"        
## [5] "Component \"P.Value\": Mean relative difference: 0.1397344"  
## [6] "Component \"adj.P.Val\": Mean relative difference: 0.142198" 
## [7] "Component \"B\": Mean relative difference: 0.06449776"</code></pre>
</div>
</div>
<div id="two-factors-paired-data" class="section level2">
<h2 class="hasAnchor">
<a href="#two-factors-paired-data" class="anchor"></a>Two Factors: Paired Data</h2>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" title="1"><span class="co"># Method 1</span></a>
<a class="sourceLine" id="cb47-2" title="2">Treat &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">factor</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"C"</span>, <span class="st">"C"</span>, <span class="st">"C"</span>, <span class="st">"T"</span>, <span class="st">"T"</span>, <span class="st">"T"</span>, <span class="st">"C"</span>, <span class="st">"C"</span>, <span class="st">"T"</span>, <span class="st">"T"</span>), <span class="dt">levels =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"C"</span>, <span class="st">"T"</span>))</a>
<a class="sourceLine" id="cb47-3" title="3">Patient &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">factor</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"D"</span>, <span class="st">"E"</span>, <span class="st">"D"</span>, <span class="st">"E"</span>), <span class="dt">levels =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"D"</span>, <span class="st">"E"</span>))</a>
<a class="sourceLine" id="cb47-4" title="4">design &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/model.matrix">model.matrix</a></span>(<span class="op">~</span><span class="st"> </span>Treat <span class="op">+</span><span class="st"> </span>Patient)</a>
<a class="sourceLine" id="cb47-5" title="5">design</a></code></pre></div>
<pre><code>##    (Intercept) TreatT PatientB PatientC PatientD PatientE
## 1            1      0        0        0        0        0
## 2            1      0        1        0        0        0
## 3            1      0        0        1        0        0
## 4            1      1        0        0        0        0
## 5            1      1        1        0        0        0
## 6            1      1        0        1        0        0
## 7            1      0        0        0        1        0
## 8            1      0        0        0        0        1
## 9            1      1        0        0        1        0
## 10           1      1        0        0        0        1
## attr(,"assign")
## [1] 0 1 2 2 2 2
## attr(,"contrasts")
## attr(,"contrasts")$Treat
## [1] "contr.treatment"
## 
## attr(,"contrasts")$Patient
## [1] "contr.treatment"</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" title="1">fit &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/lmFit">lmFit</a></span>(y, design)</a>
<a class="sourceLine" id="cb49-2" title="2">fit &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/ebayes">eBayes</a></span>(fit)</a>
<a class="sourceLine" id="cb49-3" title="3">TreatT1 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/toptable">topTable</a></span>(fit, <span class="dt">coef =</span> <span class="st">"TreatT"</span>)</a>
<a class="sourceLine" id="cb49-4" title="4"></a>
<a class="sourceLine" id="cb49-5" title="5"><span class="co"># Method 2</span></a>
<a class="sourceLine" id="cb49-6" title="6">design &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/model.matrix">model.matrix</a></span>(<span class="op">~</span><span class="st"> </span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span>Treat <span class="op">+</span><span class="st"> </span>Patient)</a>
<a class="sourceLine" id="cb49-7" title="7">design</a></code></pre></div>
<pre><code>##    TreatC TreatT PatientB PatientC PatientD PatientE
## 1       1      0        0        0        0        0
## 2       1      0        1        0        0        0
## 3       1      0        0        1        0        0
## 4       0      1        0        0        0        0
## 5       0      1        1        0        0        0
## 6       0      1        0        1        0        0
## 7       1      0        0        0        1        0
## 8       1      0        0        0        0        1
## 9       0      1        0        0        1        0
## 10      0      1        0        0        0        1
## attr(,"assign")
## [1] 1 1 2 2 2 2
## attr(,"contrasts")
## attr(,"contrasts")$Treat
## [1] "contr.treatment"
## 
## attr(,"contrasts")$Patient
## [1] "contr.treatment"</code></pre>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" title="1">fit &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/lmFit">lmFit</a></span>(y, design)</a>
<a class="sourceLine" id="cb51-2" title="2">contrast.matrix &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/makeContrasts">makeContrasts</a></span>(<span class="dt">TreatTC =</span> TreatT <span class="op">-</span><span class="st"> </span>TreatC, <span class="dt">levels =</span> design)</a>
<a class="sourceLine" id="cb51-3" title="3">fit2 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/contrasts.fit">contrasts.fit</a></span>(fit, contrast.matrix)</a>
<a class="sourceLine" id="cb51-4" title="4">fit2 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/ebayes">eBayes</a></span>(fit2)</a>
<a class="sourceLine" id="cb51-5" title="5">TreatT2 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/toptable">topTable</a></span>(fit2, <span class="dt">coef =</span> <span class="st">"TreatTC"</span>)</a>
<a class="sourceLine" id="cb51-6" title="6"></a>
<a class="sourceLine" id="cb51-7" title="7"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/all.equal">all.equal</a></span>(TreatT1, TreatT2) <span class="co"># TRUE</span></a></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>
<div id="two-factors-treatmentmutation" class="section level2">
<h2 class="hasAnchor">
<a href="#two-factors-treatmentmutation" class="anchor"></a>Two Factors: Treatment+Mutation</h2>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" title="1"><span class="co">########################################</span></a>
<a class="sourceLine" id="cb53-2" title="2"><span class="co"># Two Factors</span></a>
<a class="sourceLine" id="cb53-3" title="3"><span class="co">########################################</span></a>
<a class="sourceLine" id="cb53-4" title="4"><span class="co"># Method 1</span></a>
<a class="sourceLine" id="cb53-5" title="5">Treat &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">factor</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"C"</span>, <span class="st">"C"</span>, <span class="st">"C"</span>, <span class="st">"T"</span>, <span class="st">"T"</span>, <span class="st">"T"</span>, <span class="st">"C"</span>, <span class="st">"C"</span>, <span class="st">"T"</span>, <span class="st">"T"</span>), <span class="dt">levels =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"C"</span>, <span class="st">"T"</span>))</a>
<a class="sourceLine" id="cb53-6" title="6">Mutation &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">factor</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"Mut"</span>, <span class="st">"Mut"</span>, <span class="st">"Mut"</span>, <span class="st">"Mut"</span>, <span class="st">"Mut"</span>, <span class="st">"Mut"</span>, <span class="st">"WT"</span>, <span class="st">"WT"</span>, <span class="st">"WT"</span>, <span class="st">"WT"</span>), <span class="dt">levels =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"WT"</span>, <span class="st">"Mut"</span>))</a>
<a class="sourceLine" id="cb53-7" title="7">design &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/model.matrix">model.matrix</a></span>(<span class="op">~</span><span class="st"> </span>Treat <span class="op">+</span><span class="st"> </span>Mutation)</a>
<a class="sourceLine" id="cb53-8" title="8">design</a></code></pre></div>
<pre><code>##    (Intercept) TreatT MutationMut
## 1            1      0           1
## 2            1      0           1
## 3            1      0           1
## 4            1      1           1
## 5            1      1           1
## 6            1      1           1
## 7            1      0           0
## 8            1      0           0
## 9            1      1           0
## 10           1      1           0
## attr(,"assign")
## [1] 0 1 2
## attr(,"contrasts")
## attr(,"contrasts")$Treat
## [1] "contr.treatment"
## 
## attr(,"contrasts")$Mutation
## [1] "contr.treatment"</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" title="1">fit &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/lmFit">lmFit</a></span>(y, design)</a>
<a class="sourceLine" id="cb55-2" title="2">fit &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/ebayes">eBayes</a></span>(fit)</a>
<a class="sourceLine" id="cb55-3" title="3">MutationMut1 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/toptable">topTable</a></span>(fit, <span class="dt">coef =</span> <span class="st">"MutationMut"</span>)</a>
<a class="sourceLine" id="cb55-4" title="4">TreatTC1 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/toptable">topTable</a></span>(fit, <span class="dt">coef =</span> <span class="st">"TreatT"</span>)</a>
<a class="sourceLine" id="cb55-5" title="5"></a>
<a class="sourceLine" id="cb55-6" title="6"><span class="co"># Method 2</span></a>
<a class="sourceLine" id="cb55-7" title="7">design &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/model.matrix">model.matrix</a></span>(<span class="op">~</span><span class="st"> </span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span>Treat <span class="op">+</span><span class="st"> </span>Mutation)</a>
<a class="sourceLine" id="cb55-8" title="8">design</a></code></pre></div>
<pre><code>##    TreatC TreatT MutationMut
## 1       1      0           1
## 2       1      0           1
## 3       1      0           1
## 4       0      1           1
## 5       0      1           1
## 6       0      1           1
## 7       1      0           0
## 8       1      0           0
## 9       0      1           0
## 10      0      1           0
## attr(,"assign")
## [1] 1 1 2
## attr(,"contrasts")
## attr(,"contrasts")$Treat
## [1] "contr.treatment"
## 
## attr(,"contrasts")$Mutation
## [1] "contr.treatment"</code></pre>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb57-1" title="1">fit &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/lmFit">lmFit</a></span>(y, design)</a>
<a class="sourceLine" id="cb57-2" title="2">contrast.matrix &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/makeContrasts">makeContrasts</a></span>(<span class="dt">MutationMutWT =</span> MutationMut, <span class="dt">TreatTC =</span> TreatT <span class="op">-</span><span class="st"> </span>TreatC, <span class="dt">levels =</span> design)</a>
<a class="sourceLine" id="cb57-3" title="3">fit2 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/contrasts.fit">contrasts.fit</a></span>(fit, contrast.matrix)</a>
<a class="sourceLine" id="cb57-4" title="4">fit2 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/ebayes">eBayes</a></span>(fit2)</a>
<a class="sourceLine" id="cb57-5" title="5">MutationMut2 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/toptable">topTable</a></span>(fit2, <span class="dt">coef =</span> <span class="st">"MutationMutWT"</span>)</a>
<a class="sourceLine" id="cb57-6" title="6">TreatTC2 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/toptable">topTable</a></span>(fit2, <span class="dt">coef =</span> <span class="st">"TreatTC"</span>)</a>
<a class="sourceLine" id="cb57-7" title="7"></a>
<a class="sourceLine" id="cb57-8" title="8"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/all.equal">all.equal</a></span>(TreatTC1, TreatTC2) <span class="co"># TRUE</span></a></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb59-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/all.equal">all.equal</a></span>(MutationMut1, MutationMut2) <span class="co"># TRUE</span></a></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>
<div id="two-factors-mutation1mutation2" class="section level2">
<h2 class="hasAnchor">
<a href="#two-factors-mutation1mutation2" class="anchor"></a>Two Factors: Mutation1+Mutation2</h2>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb61-1" title="1"><span class="co">########################################</span></a>
<a class="sourceLine" id="cb61-2" title="2"><span class="co"># Two Factors</span></a>
<a class="sourceLine" id="cb61-3" title="3"><span class="co">########################################</span></a>
<a class="sourceLine" id="cb61-4" title="4"><span class="co"># Method 1</span></a>
<a class="sourceLine" id="cb61-5" title="5">Mutation1 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">factor</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"WT"</span>, <span class="st">"WT"</span>, <span class="st">"WT"</span>, <span class="st">"Mut"</span>, <span class="st">"Mut"</span>, <span class="st">"Mut"</span>, <span class="st">"WT"</span>, <span class="st">"WT"</span>, <span class="st">"WT"</span>, <span class="st">"WT"</span>), <span class="dt">levels =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"WT"</span>, <span class="st">"Mut"</span>))</a>
<a class="sourceLine" id="cb61-6" title="6">Mutation2 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">factor</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"Mut"</span>, <span class="st">"Mut"</span>, <span class="st">"Mut"</span>, <span class="st">"Mut"</span>, <span class="st">"Mut"</span>, <span class="st">"Mut"</span>, <span class="st">"WT"</span>, <span class="st">"WT"</span>, <span class="st">"WT"</span>, <span class="st">"WT"</span>), <span class="dt">levels =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"WT"</span>, <span class="st">"Mut"</span>))</a>
<a class="sourceLine" id="cb61-7" title="7">design &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/model.matrix">model.matrix</a></span>(<span class="op">~</span><span class="st"> </span>Mutation1 <span class="op">+</span><span class="st"> </span>Mutation2)</a>
<a class="sourceLine" id="cb61-8" title="8">design</a></code></pre></div>
<pre><code>##    (Intercept) Mutation1Mut Mutation2Mut
## 1            1            0            1
## 2            1            0            1
## 3            1            0            1
## 4            1            1            1
## 5            1            1            1
## 6            1            1            1
## 7            1            0            0
## 8            1            0            0
## 9            1            0            0
## 10           1            0            0
## attr(,"assign")
## [1] 0 1 2
## attr(,"contrasts")
## attr(,"contrasts")$Mutation1
## [1] "contr.treatment"
## 
## attr(,"contrasts")$Mutation2
## [1] "contr.treatment"</code></pre>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb63-1" title="1">fit &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/lmFit">lmFit</a></span>(y, design)</a>
<a class="sourceLine" id="cb63-2" title="2">fit &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/ebayes">eBayes</a></span>(fit)</a>
<a class="sourceLine" id="cb63-3" title="3">Mutation1Mut1 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/toptable">topTable</a></span>(fit, <span class="dt">coef =</span> <span class="st">"Mutation1Mut"</span>)</a>
<a class="sourceLine" id="cb63-4" title="4">Mutation2Mut1 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/toptable">topTable</a></span>(fit, <span class="dt">coef =</span> <span class="st">"Mutation2Mut"</span>)</a>
<a class="sourceLine" id="cb63-5" title="5"></a>
<a class="sourceLine" id="cb63-6" title="6"><span class="co"># Method 2</span></a>
<a class="sourceLine" id="cb63-7" title="7">design &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/model.matrix">model.matrix</a></span>(<span class="op">~</span><span class="st"> </span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span>Mutation1 <span class="op">+</span><span class="st"> </span>Mutation2)</a>
<a class="sourceLine" id="cb63-8" title="8">design</a></code></pre></div>
<pre><code>##    Mutation1WT Mutation1Mut Mutation2Mut
## 1            1            0            1
## 2            1            0            1
## 3            1            0            1
## 4            0            1            1
## 5            0            1            1
## 6            0            1            1
## 7            1            0            0
## 8            1            0            0
## 9            1            0            0
## 10           1            0            0
## attr(,"assign")
## [1] 1 1 2
## attr(,"contrasts")
## attr(,"contrasts")$Mutation1
## [1] "contr.treatment"
## 
## attr(,"contrasts")$Mutation2
## [1] "contr.treatment"</code></pre>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb65-1" title="1">fit &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/lmFit">lmFit</a></span>(y, design)</a>
<a class="sourceLine" id="cb65-2" title="2">contrast.matrix &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/makeContrasts">makeContrasts</a></span>(<span class="dt">Mutation1Mut =</span> Mutation1Mut <span class="op">-</span><span class="st"> </span>Mutation1WT, <span class="dt">Mutation2Mut =</span> Mutation2Mut, <span class="dt">levels =</span> design)</a>
<a class="sourceLine" id="cb65-3" title="3">fit2 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/contrasts.fit">contrasts.fit</a></span>(fit, contrast.matrix)</a>
<a class="sourceLine" id="cb65-4" title="4">fit2 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/ebayes">eBayes</a></span>(fit2)</a>
<a class="sourceLine" id="cb65-5" title="5">Mutation1Mut2 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/toptable">topTable</a></span>(fit2, <span class="dt">coef =</span> <span class="st">"Mutation1Mut"</span>)</a>
<a class="sourceLine" id="cb65-6" title="6">Mutation2Mut2 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/toptable">topTable</a></span>(fit2, <span class="dt">coef =</span> <span class="st">"Mutation2Mut"</span>)</a>
<a class="sourceLine" id="cb65-7" title="7"></a>
<a class="sourceLine" id="cb65-8" title="8"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/all.equal">all.equal</a></span>(Mutation1Mut1, Mutation1Mut2) <span class="co"># TRUE</span></a></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb67-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/all.equal">all.equal</a></span>(Mutation2Mut1, Mutation2Mut2) <span class="co"># TRUE</span></a></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>
<div id="with-interactions" class="section level2">
<h2 class="hasAnchor">
<a href="#with-interactions" class="anchor"></a>With Interactions:</h2>
<p>Method 2 is good and easy to write interactions</p>
<p>Similar as usersguide 9.5 Interaction Models: 2 Ã— 2 Factorial Designs. But with data to make it easier to reproduce.</p>
<div id="analysing-as-for-a-single-factor" class="section level3">
<h3 class="hasAnchor">
<a href="#analysing-as-for-a-single-factor" class="anchor"></a>Analysing as for a Single Factor</h3>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb69-1" title="1">TS &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(Mutation, Treat, <span class="dt">sep =</span> <span class="st">"."</span>)</a>
<a class="sourceLine" id="cb69-2" title="2">TS &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">factor</a></span>(TS, <span class="dt">levels =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"Mut.C"</span>, <span class="st">"Mut.T"</span>, <span class="st">"WT.C"</span>, <span class="st">"WT.T"</span>))</a>
<a class="sourceLine" id="cb69-3" title="3"></a>
<a class="sourceLine" id="cb69-4" title="4">design &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/model.matrix">model.matrix</a></span>(<span class="op">~</span><span class="st"> </span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span>TS)</a>
<a class="sourceLine" id="cb69-5" title="5"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/colnames">colnames</a></span>(design) &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/levels">levels</a></span>(TS)</a>
<a class="sourceLine" id="cb69-6" title="6">design</a></code></pre></div>
<pre><code>##    Mut.C Mut.T WT.C WT.T
## 1      1     0    0    0
## 2      1     0    0    0
## 3      1     0    0    0
## 4      0     1    0    0
## 5      0     1    0    0
## 6      0     1    0    0
## 7      0     0    1    0
## 8      0     0    1    0
## 9      0     0    0    1
## 10     0     0    0    1
## attr(,"assign")
## [1] 1 1 1 1
## attr(,"contrasts")
## attr(,"contrasts")$TS
## [1] "contr.treatment"</code></pre>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb71-1" title="1">fit &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/lmFit">lmFit</a></span>(y, design)</a>
<a class="sourceLine" id="cb71-2" title="2">contrast.matrix &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/makeContrasts">makeContrasts</a></span>(</a>
<a class="sourceLine" id="cb71-3" title="3">  <span class="dt">TvsCinWT =</span> WT.T <span class="op">-</span><span class="st"> </span>WT.C,</a>
<a class="sourceLine" id="cb71-4" title="4">  <span class="dt">TvsCinMu =</span> Mut.T <span class="op">-</span><span class="st"> </span>Mut.C,</a>
<a class="sourceLine" id="cb71-5" title="5">  <span class="dt">MuvsWtinC =</span> Mut.C <span class="op">-</span><span class="st"> </span>WT.C,</a>
<a class="sourceLine" id="cb71-6" title="6">  <span class="dt">MuvsWtinT =</span> Mut.T <span class="op">-</span><span class="st"> </span>WT.T,</a>
<a class="sourceLine" id="cb71-7" title="7">  <span class="dt">Diff =</span> (Mut.T <span class="op">-</span><span class="st"> </span>Mut.C) <span class="op">-</span><span class="st"> </span>(WT.T <span class="op">-</span><span class="st"> </span>WT.C),</a>
<a class="sourceLine" id="cb71-8" title="8">  <span class="dt">levels =</span> design</a>
<a class="sourceLine" id="cb71-9" title="9">)</a>
<a class="sourceLine" id="cb71-10" title="10">fit2 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/contrasts.fit">contrasts.fit</a></span>(fit, contrast.matrix)</a>
<a class="sourceLine" id="cb71-11" title="11">fit2 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/ebayes">eBayes</a></span>(fit2)</a>
<a class="sourceLine" id="cb71-12" title="12">TvsCinMu1 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/toptable">topTable</a></span>(fit2, <span class="dt">coef =</span> <span class="st">"TvsCinMu"</span>)</a>
<a class="sourceLine" id="cb71-13" title="13">TvsCinWT1 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/toptable">topTable</a></span>(fit2, <span class="dt">coef =</span> <span class="st">"TvsCinWT"</span>)</a>
<a class="sourceLine" id="cb71-14" title="14">MuvsWtinC1 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/toptable">topTable</a></span>(fit2, <span class="dt">coef =</span> <span class="st">"MuvsWtinC"</span>)</a>
<a class="sourceLine" id="cb71-15" title="15">MuvsWtinT1 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/toptable">topTable</a></span>(fit2, <span class="dt">coef =</span> <span class="st">"MuvsWtinT"</span>)</a>
<a class="sourceLine" id="cb71-16" title="16"></a>
<a class="sourceLine" id="cb71-17" title="17">diff1 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/toptable">topTable</a></span>(fit2, <span class="dt">coef =</span> <span class="st">"Diff"</span>)</a></code></pre></div>
</div>
<div id="a-nested-interaction-formula" class="section level3">
<h3 class="hasAnchor">
<a href="#a-nested-interaction-formula" class="anchor"></a>A Nested Interaction Formula</h3>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb72-1" title="1"><span class="co"># design &lt;- model.matrix(~Mutation+Treat+Mutation:Treat)</span></a>
<a class="sourceLine" id="cb72-2" title="2">design &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/model.matrix">model.matrix</a></span>(<span class="op">~</span><span class="st"> </span>Mutation <span class="op">+</span><span class="st"> </span>Mutation<span class="op">:</span>Treat)</a>
<a class="sourceLine" id="cb72-3" title="3">design</a></code></pre></div>
<pre><code>##    (Intercept) MutationMut MutationWT:TreatT MutationMut:TreatT
## 1            1           1                 0                  0
## 2            1           1                 0                  0
## 3            1           1                 0                  0
## 4            1           1                 0                  1
## 5            1           1                 0                  1
## 6            1           1                 0                  1
## 7            1           0                 0                  0
## 8            1           0                 0                  0
## 9            1           0                 1                  0
## 10           1           0                 1                  0
## attr(,"assign")
## [1] 0 1 2 2
## attr(,"contrasts")
## attr(,"contrasts")$Mutation
## [1] "contr.treatment"
## 
## attr(,"contrasts")$Treat
## [1] "contr.treatment"</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb74-1" title="1">fit &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/lmFit">lmFit</a></span>(y, design)</a>
<a class="sourceLine" id="cb74-2" title="2">fit &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/ebayes">eBayes</a></span>(fit)</a>
<a class="sourceLine" id="cb74-3" title="3">TvsCinWT2 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/toptable">topTable</a></span>(fit, <span class="dt">coef =</span> <span class="st">"MutationWT:TreatT"</span>)</a>
<a class="sourceLine" id="cb74-4" title="4">TvsCinMu2 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/toptable">topTable</a></span>(fit, <span class="dt">coef =</span> <span class="st">"MutationMut:TreatT"</span>)</a>
<a class="sourceLine" id="cb74-5" title="5"></a>
<a class="sourceLine" id="cb74-6" title="6"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/all.equal">all.equal</a></span>(TvsCinWT1, TvsCinWT2) <span class="co"># TRUE</span></a></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb76-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/all.equal">all.equal</a></span>(TvsCinMu1, TvsCinMu2) <span class="co"># TRUE</span></a></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb78-1" title="1"><span class="co"># we could extract the interaction contrast Diff considered in "Single Factor" part by</span></a>
<a class="sourceLine" id="cb78-2" title="2">fit2 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/contrasts.fit">contrasts.fit</a></span>(fit, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">-1</span>, <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb78-3" title="3">fit2 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/ebayes">eBayes</a></span>(fit2)</a>
<a class="sourceLine" id="cb78-4" title="4">diff2 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/toptable">topTable</a></span>(fit2)</a>
<a class="sourceLine" id="cb78-5" title="5"></a>
<a class="sourceLine" id="cb78-6" title="6"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/all.equal">all.equal</a></span>(diff1, diff2) <span class="co"># TRUE</span></a></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>
<div id="classic-interaction-models" class="section level3">
<h3 class="hasAnchor">
<a href="#classic-interaction-models" class="anchor"></a>Classic Interaction Models</h3>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb80-1" title="1">design &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/model.matrix">model.matrix</a></span>(<span class="op">~</span><span class="st"> </span>Mutation <span class="op">*</span><span class="st"> </span>Treat)</a>
<a class="sourceLine" id="cb80-2" title="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/colnames">colnames</a></span>(design) &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/grep">gsub</a></span>(<span class="st">":|</span><span class="ch">\\</span><span class="st">(|</span><span class="ch">\\</span><span class="st">)"</span>, <span class="st">"."</span>, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/colnames">colnames</a></span>(design))</a>
<a class="sourceLine" id="cb80-3" title="3">design</a></code></pre></div>
<pre><code>##    .Intercept. MutationMut TreatT MutationMut.TreatT
## 1            1           1      0                  0
## 2            1           1      0                  0
## 3            1           1      0                  0
## 4            1           1      1                  1
## 5            1           1      1                  1
## 6            1           1      1                  1
## 7            1           0      0                  0
## 8            1           0      0                  0
## 9            1           0      1                  0
## 10           1           0      1                  0
## attr(,"assign")
## [1] 0 1 2 3
## attr(,"contrasts")
## attr(,"contrasts")$Mutation
## [1] "contr.treatment"
## 
## attr(,"contrasts")$Treat
## [1] "contr.treatment"</code></pre>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb82-1" title="1"><span class="co"># We need to use contrasts to extract all the comparisons of interest, as we are interested in Mu.S-Mu.U but it is not in design</span></a>
<a class="sourceLine" id="cb82-2" title="2">fit &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/lmFit">lmFit</a></span>(y, design)</a>
<a class="sourceLine" id="cb82-3" title="3"><span class="co"># contrast.matrix &lt;- cbind(TvsCinWT=c(0,0,1,0),TvsCinMu=c(0,0,1,1),Diff=c(0,0,0,1))</span></a>
<a class="sourceLine" id="cb82-4" title="4">contrast.matrix &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/makeContrasts">makeContrasts</a></span>(</a>
<a class="sourceLine" id="cb82-5" title="5">  <span class="dt">MuvsWtinC =</span> MutationMut,</a>
<a class="sourceLine" id="cb82-6" title="6">  <span class="dt">MuvsWtinT =</span> MutationMut <span class="op">+</span><span class="st"> </span>MutationMut.TreatT,</a>
<a class="sourceLine" id="cb82-7" title="7">  <span class="dt">TvsCinWT =</span> TreatT,</a>
<a class="sourceLine" id="cb82-8" title="8">  <span class="dt">TvsCinMu =</span> TreatT <span class="op">+</span><span class="st"> </span>MutationMut.TreatT,</a>
<a class="sourceLine" id="cb82-9" title="9">  <span class="dt">Diff =</span> MutationMut.TreatT,</a>
<a class="sourceLine" id="cb82-10" title="10">  <span class="dt">levels =</span> design</a>
<a class="sourceLine" id="cb82-11" title="11">)</a>
<a class="sourceLine" id="cb82-12" title="12"></a>
<a class="sourceLine" id="cb82-13" title="13">fit2 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/contrasts.fit">contrasts.fit</a></span>(fit, contrast.matrix)</a>
<a class="sourceLine" id="cb82-14" title="14">fit2 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/ebayes">eBayes</a></span>(fit2)</a>
<a class="sourceLine" id="cb82-15" title="15"></a>
<a class="sourceLine" id="cb82-16" title="16">MuvsWtinC3 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/toptable">topTable</a></span>(fit2, <span class="dt">coef =</span> <span class="st">"MuvsWtinC"</span>)</a>
<a class="sourceLine" id="cb82-17" title="17">MuvsWtinT3 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/toptable">topTable</a></span>(fit2, <span class="dt">coef =</span> <span class="st">"MuvsWtinT"</span>)</a>
<a class="sourceLine" id="cb82-18" title="18">TvsCinWT3 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/toptable">topTable</a></span>(fit2, <span class="dt">coef =</span> <span class="st">"TvsCinWT"</span>)</a>
<a class="sourceLine" id="cb82-19" title="19">TvsCinMu3 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/toptable">topTable</a></span>(fit2, <span class="dt">coef =</span> <span class="st">"TvsCinMu"</span>)</a>
<a class="sourceLine" id="cb82-20" title="20">diff3 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/toptable">topTable</a></span>(fit2, <span class="dt">coef =</span> <span class="st">"Diff"</span>)</a>
<a class="sourceLine" id="cb82-21" title="21"></a>
<a class="sourceLine" id="cb82-22" title="22"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/all.equal">all.equal</a></span>(TvsCinWT2, TvsCinWT3)</a></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb84-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/all.equal">all.equal</a></span>(TvsCinMu2, TvsCinMu3)</a></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb86-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/all.equal">all.equal</a></span>(diff1, diff3)</a></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb88-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/all.equal">all.equal</a></span>(MuvsWtinC1, MuvsWtinC3)</a></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb90-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/all.equal">all.equal</a></span>(MuvsWtinT1, MuvsWtinT3)</a></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>
</div>
</div>
<div id="make-functions" class="section level1">
<h1 class="hasAnchor">
<a href="#make-functions" class="anchor"></a>Make functions</h1>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb92-1" title="1">rawDataTable &lt;-<span class="st"> </span>y</a>
<a class="sourceLine" id="cb92-2" title="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/colnames">colnames</a></span>(rawDataTable) &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste0</a></span>(<span class="st">"Sample"</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>)</a>
<a class="sourceLine" id="cb92-3" title="3"></a>
<a class="sourceLine" id="cb92-4" title="4">makeDesignTable &lt;-<span class="st"> </span><span class="cf">function</span>(rawDataTable, factorTable,<span class="dt">factorInDesign=</span><span class="ot">NULL</span>) {</a>
<a class="sourceLine" id="cb92-5" title="5">  <span class="cf">if</span> (<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/NULL">is.null</a></span>(factorInDesign)) {</a>
<a class="sourceLine" id="cb92-6" title="6">    factorInDesign=<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/character">as.character</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/unique">unique</a></span>(factorTable[, <span class="dv">2</span>]))</a>
<a class="sourceLine" id="cb92-7" title="7">  }</a>
<a class="sourceLine" id="cb92-8" title="8">  designTable &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/matrix">matrix</a></span>(<span class="dv">0</span>, <span class="dt">nrow =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/nrow">ncol</a></span>(rawDataTable), <span class="dt">ncol =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(factorInDesign))</a>
<a class="sourceLine" id="cb92-9" title="9">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/row.names">row.names</a></span>(designTable) &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/colnames">colnames</a></span>(rawDataTable)</a>
<a class="sourceLine" id="cb92-10" title="10">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/colnames">colnames</a></span>(designTable) &lt;-<span class="st"> </span>factorInDesign</a>
<a class="sourceLine" id="cb92-11" title="11"></a>
<a class="sourceLine" id="cb92-12" title="12">  designTable[<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/matrix">as.matrix</a></span>(factorTable)] &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb92-13" title="13">  designTable</a>
<a class="sourceLine" id="cb92-14" title="14">  designTable &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/cbind">cbind</a></span>(<span class="dt">Intercept =</span> <span class="dv">1</span>, designTable)</a>
<a class="sourceLine" id="cb92-15" title="15">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/function">return</a></span>(designTable)</a>
<a class="sourceLine" id="cb92-16" title="16">}</a>
<a class="sourceLine" id="cb92-17" title="17"></a>
<a class="sourceLine" id="cb92-18" title="18"></a>
<a class="sourceLine" id="cb92-19" title="19">performLimma &lt;-<span class="st"> </span><span class="cf">function</span>(rawDataTable, designTable, <span class="dt">contrastsText =</span> <span class="ot">NULL</span>) {</a>
<a class="sourceLine" id="cb92-20" title="20">  <span class="cf">if</span> (<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/NULL">is.null</a></span>(contrastsText)) {</a>
<a class="sourceLine" id="cb92-21" title="21">    contrastsText &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/colnames">colnames</a></span>(designTable)[<span class="op">-</span><span class="dv">1</span>])</a>
<a class="sourceLine" id="cb92-22" title="22">  }</a>
<a class="sourceLine" id="cb92-23" title="23"></a>
<a class="sourceLine" id="cb92-24" title="24">  fit &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/lmFit">lmFit</a></span>(rawDataTable, designTable)</a>
<a class="sourceLine" id="cb92-25" title="25">  contrast.matrix &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/makeContrasts">makeContrasts</a></span>(<span class="dt">contrasts =</span> contrastsText, <span class="dt">levels =</span> designTable)</a>
<a class="sourceLine" id="cb92-26" title="26">  fit2 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/contrasts.fit">contrasts.fit</a></span>(fit, contrast.matrix)</a>
<a class="sourceLine" id="cb92-27" title="27">  fit2 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/ebayes">eBayes</a></span>(fit2)</a>
<a class="sourceLine" id="cb92-28" title="28">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/function">return</a></span>(fit2)</a>
<a class="sourceLine" id="cb92-29" title="29">}</a></code></pre></div>
<div id="one-factor-three-groups-1" class="section level2">
<h2 class="hasAnchor">
<a href="#one-factor-three-groups-1" class="anchor"></a>One Factor: Three Groups</h2>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb93-1" title="1">factorTable &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(<span class="dt">Factor1 =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"Sample4"</span>, <span class="st">"Sample5"</span>, <span class="st">"Sample6"</span>, <span class="st">"Sample7"</span>, <span class="st">"Sample8"</span>, <span class="st">"Sample9"</span>, <span class="st">"Sample10"</span>), <span class="dt">Factor2 =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"TreatT"</span>, <span class="st">"TreatT"</span>, <span class="st">"TreatT"</span>, <span class="st">"TreatG"</span>, <span class="st">"TreatG"</span>, <span class="st">"TreatG"</span>, <span class="st">"TreatG"</span>), <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb93-2" title="2">factorTable</a></code></pre></div>
<pre><code>##    Factor1 Factor2
## 1  Sample4  TreatT
## 2  Sample5  TreatT
## 3  Sample6  TreatT
## 4  Sample7  TreatG
## 5  Sample8  TreatG
## 6  Sample9  TreatG
## 7 Sample10  TreatG</code></pre>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb95-1" title="1">designTable &lt;-<span class="st"> </span><span class="kw">makeDesignTable</span>(rawDataTable, factorTable)</a>
<a class="sourceLine" id="cb95-2" title="2">fit3 &lt;-<span class="st"> </span><span class="kw">performLimma</span>(rawDataTable, designTable)</a>
<a class="sourceLine" id="cb95-3" title="3">TreatThreeT3 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/toptable">topTable</a></span>(fit3, <span class="dt">coef =</span> <span class="st">"TreatT"</span>)</a>
<a class="sourceLine" id="cb95-4" title="4">TreatThreeG3 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/toptable">topTable</a></span>(fit3, <span class="dt">coef =</span> <span class="st">"TreatG"</span>)</a>
<a class="sourceLine" id="cb95-5" title="5"></a>
<a class="sourceLine" id="cb95-6" title="6"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/all.equal">all.equal</a></span>(TreatThreeT1, TreatThreeT3) <span class="co"># True</span></a></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb97-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/all.equal">all.equal</a></span>(TreatThreeG1, TreatThreeG3) <span class="co"># True</span></a></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>
<div id="two-factors-paired-data-1" class="section level2">
<h2 class="hasAnchor">
<a href="#two-factors-paired-data-1" class="anchor"></a>Two Factors: Paired Data</h2>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb99-1" title="1">factorTable &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(<span class="dt">Factor1 =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"Sample4"</span>, <span class="st">"Sample5"</span>, <span class="st">"Sample6"</span>, <span class="st">"Sample9"</span>, <span class="st">"Sample10"</span>, <span class="st">"Sample2"</span>, <span class="st">"Sample3"</span>, <span class="st">"Sample5"</span>, <span class="st">"Sample6"</span>, <span class="st">"Sample7"</span>, <span class="st">"Sample8"</span>, <span class="st">"Sample9"</span>, <span class="st">"Sample10"</span>), <span class="dt">Factor2 =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"TreatT"</span>, <span class="st">"TreatT"</span>, <span class="st">"TreatT"</span>, <span class="st">"TreatT"</span>, <span class="st">"TreatT"</span>, <span class="st">"PatientB"</span>, <span class="st">"PatientC"</span>, <span class="st">"PatientB"</span>, <span class="st">"PatientC"</span>, <span class="st">"PatientD"</span>, <span class="st">"PatientE"</span>, <span class="st">"PatientD"</span>, <span class="st">"PatientE"</span>), <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb99-2" title="2">factorTable</a></code></pre></div>
<pre><code>##     Factor1  Factor2
## 1   Sample4   TreatT
## 2   Sample5   TreatT
## 3   Sample6   TreatT
## 4   Sample9   TreatT
## 5  Sample10   TreatT
## 6   Sample2 PatientB
## 7   Sample3 PatientC
## 8   Sample5 PatientB
## 9   Sample6 PatientC
## 10  Sample7 PatientD
## 11  Sample8 PatientE
## 12  Sample9 PatientD
## 13 Sample10 PatientE</code></pre>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb101-1" title="1">designTable &lt;-<span class="st"> </span><span class="kw">makeDesignTable</span>(rawDataTable, factorTable)</a>
<a class="sourceLine" id="cb101-2" title="2">fit3 &lt;-<span class="st"> </span><span class="kw">performLimma</span>(rawDataTable, designTable)</a>
<a class="sourceLine" id="cb101-3" title="3">TreatT3 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/toptable">topTable</a></span>(fit3, <span class="dt">coef =</span> <span class="st">"TreatT"</span>)</a>
<a class="sourceLine" id="cb101-4" title="4"></a>
<a class="sourceLine" id="cb101-5" title="5"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/all.equal">all.equal</a></span>(TreatT2, TreatT3) <span class="co"># True</span></a></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>
<div id="two-factors-treatmentmutation-1" class="section level2">
<h2 class="hasAnchor">
<a href="#two-factors-treatmentmutation-1" class="anchor"></a>Two Factors: Treatment+Mutation</h2>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb103-1" title="1">factorTable &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(<span class="dt">Factor1 =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"Sample4"</span>, <span class="st">"Sample5"</span>, <span class="st">"Sample6"</span>, <span class="st">"Sample9"</span>, <span class="st">"Sample10"</span>, <span class="st">"Sample1"</span>, <span class="st">"Sample2"</span>, <span class="st">"Sample3"</span>, <span class="st">"Sample4"</span>, <span class="st">"Sample5"</span>, <span class="st">"Sample6"</span>), <span class="dt">Factor2 =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"TreatT"</span>, <span class="st">"TreatT"</span>, <span class="st">"TreatT"</span>, <span class="st">"TreatT"</span>, <span class="st">"TreatT"</span>, <span class="st">"MutationMut"</span>, <span class="st">"MutationMut"</span>, <span class="st">"MutationMut"</span>, <span class="st">"MutationMut"</span>, <span class="st">"MutationMut"</span>, <span class="st">"MutationMut"</span>), <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb103-2" title="2">factorTable</a></code></pre></div>
<pre><code>##     Factor1     Factor2
## 1   Sample4      TreatT
## 2   Sample5      TreatT
## 3   Sample6      TreatT
## 4   Sample9      TreatT
## 5  Sample10      TreatT
## 6   Sample1 MutationMut
## 7   Sample2 MutationMut
## 8   Sample3 MutationMut
## 9   Sample4 MutationMut
## 10  Sample5 MutationMut
## 11  Sample6 MutationMut</code></pre>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb105-1" title="1">designTable &lt;-<span class="st"> </span><span class="kw">makeDesignTable</span>(rawDataTable, factorTable)</a>
<a class="sourceLine" id="cb105-2" title="2">fit3 &lt;-<span class="st"> </span><span class="kw">performLimma</span>(rawDataTable, designTable)</a>
<a class="sourceLine" id="cb105-3" title="3">TreatTC3 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/toptable">topTable</a></span>(fit3, <span class="dt">coef =</span> <span class="st">"TreatT"</span>)</a>
<a class="sourceLine" id="cb105-4" title="4">MutationMut3 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/limma/topics/toptable">topTable</a></span>(fit3, <span class="dt">coef =</span> <span class="st">"MutationMut"</span>)</a>
<a class="sourceLine" id="cb105-5" title="5"></a>
<a class="sourceLine" id="cb105-6" title="6"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/all.equal">all.equal</a></span>(TreatTC2, TreatTC3) <span class="co"># True</span></a></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb107-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/all.equal">all.equal</a></span>(MutationMut2, MutationMut3) <span class="co"># True</span></a></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>
</div>
<div id="perform-limma-pipeline" class="section level1">
<h1 class="hasAnchor">
<a href="#perform-limma-pipeline" class="anchor"></a>Perform limma Pipeline</h1>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb109-1" title="1"><span class="co">########################################################</span></a>
<a class="sourceLine" id="cb109-2" title="2"><span class="co"># Data prepare. For test, Should NOT in pipeline</span></a>
<a class="sourceLine" id="cb109-3" title="3"><span class="co">########################################################</span></a>
<a class="sourceLine" id="cb109-4" title="4"><span class="co"># library(reshape2)</span></a>
<a class="sourceLine" id="cb109-5" title="5"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(tidyverse)</a>
<a class="sourceLine" id="cb109-6" title="6"></a>
<a class="sourceLine" id="cb109-7" title="7"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/getwd">setwd</a></span>(<span class="st">"D:/OneDriveWork/OneDriveVanderbilt/work/AnthonyDaniels/20190509_proteomicsReDo"</span>)</a>
<a class="sourceLine" id="cb109-8" title="8">proteinExpression &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/readRDS">readRDS</a></span>(<span class="st">"20190827_withMatchedNormalProteinExpression.rds"</span>)</a>
<a class="sourceLine" id="cb109-9" title="9"></a>
<a class="sourceLine" id="cb109-10" title="10"><span class="co"># rawData=proteinExpression  %&gt;% spread(Sample, nLog2)</span></a>
<a class="sourceLine" id="cb109-11" title="11"><span class="co"># order by abs value of rev(nLog2) so that distinct will keep the first (largest) row</span></a>
<a class="sourceLine" id="cb109-12" title="12">temp &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/MathFun">abs</a></span>(proteinExpression<span class="op">$</span>nLog2)</a>
<a class="sourceLine" id="cb109-13" title="13">rawData &lt;-<span class="st"> </span>proteinExpression[<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rev">rev</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/order">order</a></span>(temp)), ] <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb109-14" title="14"><span class="st">  </span><span class="kw">distinct</span>(pID, Sample, <span class="dt">.keep_all =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb109-15" title="15"><span class="st">  </span><span class="kw">spread</span>(Sample, nLog2)</a>
<a class="sourceLine" id="cb109-16" title="16">rawData &lt;-<span class="st"> </span>rawData <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">distinct</span>(pID, <span class="dt">.keep_all =</span> <span class="ot">TRUE</span>) <span class="co"># remove duplicate pID, most are error</span></a>
<a class="sourceLine" id="cb109-17" title="17"></a>
<a class="sourceLine" id="cb109-18" title="18"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/row.names">row.names</a></span>(rawData) &lt;-<span class="st"> </span>rawData[, <span class="dv">1</span>]</a>
<a class="sourceLine" id="cb109-19" title="19">rawData &lt;-<span class="st"> </span>rawData[, <span class="dv">-1</span>]</a>
<a class="sourceLine" id="cb109-20" title="20"></a>
<a class="sourceLine" id="cb109-21" title="21"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/write.table">write.csv</a></span>(rawData, <span class="st">"D:</span><span class="ch">\\</span><span class="st">OneDriveWork</span><span class="ch">\\</span><span class="st">OneDriveVanderbilt</span><span class="ch">\\</span><span class="st">work</span><span class="ch">\\</span><span class="st">AnthonyDaniels</span><span class="ch">\\</span><span class="st">20190903_proteomicsLimma</span><span class="ch">\\</span><span class="st">20190903_threeTumorNormalPair.csv"</span>)</a></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#makedesign-and-contrast-in-one-factor-two-methods">MakeDesign and Contrast in One Factor: Two methods</a></li>
      <li>
<a href="#examples-with-data">Examples with Data</a><ul class="nav nav-pills nav-stacked">
<li><a href="#one-factor-three-groups">One Factor: Three Groups</a></li>
      <li><a href="#one-factor-three-groups-each-group-compare-with-rest">One Factor: Three Groups, each group compare with rest</a></li>
      <li><a href="#other-tests">Other tests</a></li>
      <li><a href="#two-factors-paired-data">Two Factors: Paired Data</a></li>
      <li><a href="#two-factors-treatmentmutation">Two Factors: Treatment+Mutation</a></li>
      <li><a href="#two-factors-mutation1mutation2">Two Factors: Mutation1+Mutation2</a></li>
      <li><a href="#with-interactions">With Interactions:</a></li>
      </ul>
</li>
      <li>
<a href="#make-functions">Make functions</a><ul class="nav nav-pills nav-stacked">
<li><a href="#one-factor-three-groups-1">One Factor: Three Groups</a></li>
      <li><a href="#two-factors-paired-data-1">Two Factors: Paired Data</a></li>
      <li><a href="#two-factors-treatmentmutation-1">Two Factors: Treatment+Mutation</a></li>
      </ul>
</li>
      <li><a href="#perform-limma-pipeline">Perform limma Pipeline</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by The package maintainer.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
