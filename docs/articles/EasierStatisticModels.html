<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Statistic Methods Example â€¢ cqsR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Statistic Methods Example">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">cqsR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/AdvancedR.html">Advanced R</a>
    </li>
    <li>
      <a href="../articles/EasierStatisticModels.html">Statistic Methods Example</a>
    </li>
    <li>
      <a href="../articles/limmaTestAndDesign.html">limma Test and Design</a>
    </li>
    <li>
      <a href="../articles/matchVcfToGr.html">Untitled</a>
    </li>
    <li>
      <a href="../articles/reportExample.html">Report Example</a>
    </li>
    <li>
      <a href="../articles/RforDataScienceNotes.html">R for Data Science Notes</a>
    </li>
    <li>
      <a href="../articles/RnaSeqSampleSize2.html">Development of RnaSeqSampleSize version 2</a>
    </li>
    <li>
      <a href="../articles/RPackageExamples.html">R Packages Examples</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Statistic Methods Example</h1>
                        <h4 class="author">Shilin Zhao</h4>
            
            <h4 class="date">26 February, 2020</h4>
      
      
      <div class="hidden name"><code>EasierStatisticModels.Rmd</code></div>

    </div>

    
    
<div id="functions-and-packages" class="section level2">
<h2 class="hasAnchor">
<a href="#functions-and-packages" class="anchor"></a>Functions and packages</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(knitr)</a></code></pre></div>
<pre><code>## Warning: package 'knitr' was built under R version 3.6.1</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(ggplot2)</a></code></pre></div>
<pre><code>## Warning: package 'ggplot2' was built under R version 3.6.2</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(RColorBrewer)</a>
<a class="sourceLine" id="cb5-2" title="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(reshape2)</a></code></pre></div>
<pre><code>## Warning: package 'reshape2' was built under R version 3.6.1</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(formattable)</a></code></pre></div>
<pre><code>## Warning: package 'formattable' was built under R version 3.6.1</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(rms)</a></code></pre></div>
<pre><code>## Warning: package 'rms' was built under R version 3.6.1</code></pre>
<pre><code>## Loading required package: Hmisc</code></pre>
<pre><code>## Warning: package 'Hmisc' was built under R version 3.6.1</code></pre>
<pre><code>## Loading required package: lattice</code></pre>
<pre><code>## Loading required package: survival</code></pre>
<pre><code>## Loading required package: Formula</code></pre>
<pre><code>## 
## Attaching package: 'Hmisc'</code></pre>
<pre><code>## The following objects are masked from 'package:base':
## 
##     format.pval, units</code></pre>
<pre><code>## Loading required package: SparseM</code></pre>
<pre><code>## 
## Attaching package: 'SparseM'</code></pre>
<pre><code>## The following object is masked from 'package:base':
## 
##     backsolve</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(htmlTable)</a></code></pre></div>
<pre><code>## Warning: package 'htmlTable' was built under R version 3.6.1</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(cqsR)</a></code></pre></div>
<pre><code>## Loading required package: data.table</code></pre>
<pre><code>## Warning: package 'data.table' was built under R version 3.6.1</code></pre>
<pre><code>## 
## Attaching package: 'data.table'</code></pre>
<pre><code>## The following objects are masked from 'package:reshape2':
## 
##     dcast, melt</code></pre>
<pre><code>## Loading required package: VariantAnnotation</code></pre>
<pre><code>## Loading required package: BiocGenerics</code></pre>
<pre><code>## Loading required package: parallel</code></pre>
<pre><code>## 
## Attaching package: 'BiocGenerics'</code></pre>
<pre><code>## The following objects are masked from 'package:parallel':
## 
##     clusterApply, clusterApplyLB, clusterCall, clusterEvalQ, clusterExport, clusterMap, parApply, parCapply, parLapply, parLapplyLB, parRapply, parSapply, parSapplyLB</code></pre>
<pre><code>## The following object is masked from 'package:formattable':
## 
##     normalize</code></pre>
<pre><code>## The following objects are masked from 'package:stats':
## 
##     IQR, mad, sd, var, xtabs</code></pre>
<pre><code>## The following objects are masked from 'package:base':
## 
##     anyDuplicated, append, as.data.frame, basename, cbind, colnames, dirname, do.call, duplicated, eval, evalq, Filter, Find, get, grep, grepl, intersect, is.unsorted, lapply, Map, mapply, match, mget, order, paste, pmax, pmax.int, pmin, pmin.int, Position, rank, rbind, Reduce, rownames, sapply, setdiff, sort, table, tapply, union, unique, unsplit, which, which.max, which.min</code></pre>
<pre><code>## Loading required package: GenomeInfoDb</code></pre>
<pre><code>## Loading required package: S4Vectors</code></pre>
<pre><code>## Loading required package: stats4</code></pre>
<pre><code>## 
## Attaching package: 'S4Vectors'</code></pre>
<pre><code>## The following objects are masked from 'package:data.table':
## 
##     first, second</code></pre>
<pre><code>## The following object is masked from 'package:base':
## 
##     expand.grid</code></pre>
<pre><code>## Loading required package: IRanges</code></pre>
<pre><code>## 
## Attaching package: 'IRanges'</code></pre>
<pre><code>## The following object is masked from 'package:data.table':
## 
##     shift</code></pre>
<pre><code>## The following object is masked from 'package:grDevices':
## 
##     windows</code></pre>
<pre><code>## Loading required package: GenomicRanges</code></pre>
<pre><code>## Loading required package: SummarizedExperiment</code></pre>
<pre><code>## Loading required package: Biobase</code></pre>
<pre><code>## Welcome to Bioconductor
## 
##     Vignettes contain introductory material; view with 'browseVignettes()'. To cite Bioconductor, see 'citation("Biobase")', and for packages 'citation("pkgname")'.</code></pre>
<pre><code>## 
## Attaching package: 'Biobase'</code></pre>
<pre><code>## The following object is masked from 'package:Hmisc':
## 
##     contents</code></pre>
<pre><code>## Loading required package: DelayedArray</code></pre>
<pre><code>## Loading required package: matrixStats</code></pre>
<pre><code>## Warning: package 'matrixStats' was built under R version 3.6.1</code></pre>
<pre><code>## 
## Attaching package: 'matrixStats'</code></pre>
<pre><code>## The following objects are masked from 'package:Biobase':
## 
##     anyMissing, rowMedians</code></pre>
<pre><code>## Loading required package: BiocParallel</code></pre>
<pre><code>## 
## Attaching package: 'DelayedArray'</code></pre>
<pre><code>## The following objects are masked from 'package:matrixStats':
## 
##     colMaxs, colMins, colRanges, rowMaxs, rowMins, rowRanges</code></pre>
<pre><code>## The following objects are masked from 'package:base':
## 
##     aperm, apply, rowsum</code></pre>
<pre><code>## Loading required package: Rsamtools</code></pre>
<pre><code>## Loading required package: Biostrings</code></pre>
<pre><code>## Loading required package: XVector</code></pre>
<pre><code>## 
## Attaching package: 'Biostrings'</code></pre>
<pre><code>## The following object is masked from 'package:DelayedArray':
## 
##     type</code></pre>
<pre><code>## The following objects are masked from 'package:Hmisc':
## 
##     mask, translate</code></pre>
<pre><code>## The following object is masked from 'package:base':
## 
##     strsplit</code></pre>
<pre><code>## 
## Attaching package: 'VariantAnnotation'</code></pre>
<pre><code>## The following object is masked from 'package:base':
## 
##     tabulate</code></pre>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb70-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/source">source</a></span>(<span class="st">'D:/source/cqsR/R/rmsEasierModel.R'</span>)</a>
<a class="sourceLine" id="cb70-2" title="2"><span class="co">#devtools::source_url("https://raw.github.com/slzhao/cqsR/master/R/rmsEasierModel.R")</span></a></code></pre></div>
</div>
<div id="make-data" class="section level2">
<h2 class="hasAnchor">
<a href="#make-data" class="anchor"></a>Make Data</h2>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb71-1" title="1">rawData&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/matrix">matrix</a></span>(<span class="dt">nrow=</span><span class="dv">200</span>,<span class="dt">ncol=</span><span class="dv">10</span>,<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Normal">rnorm</a></span>(<span class="dv">200</span><span class="op">*</span><span class="dv">10</span>))</a>
<a class="sourceLine" id="cb71-2" title="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/row.names">row.names</a></span>(rawData)&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste0</a></span>(<span class="st">"Sample"</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">200</span>)</a>
<a class="sourceLine" id="cb71-3" title="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/colnames">colnames</a></span>(rawData)&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste0</a></span>(<span class="st">"Feature"</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>)</a>
<a class="sourceLine" id="cb71-4" title="4">rawData&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(rawData,<span class="dt">FeatureYN1=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sample">sample</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dv">200</span>,<span class="dt">replace =</span> <span class="ot">TRUE</span>),<span class="dt">FeatureCategory1=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sample">sample</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"F"</span>,<span class="st">"E"</span>),<span class="dv">200</span>,<span class="dt">replace =</span> <span class="ot">TRUE</span>),<span class="dt">FeatureCategory2=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sample">sample</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"A"</span>,<span class="st">"B"</span>,<span class="st">"C"</span>,<span class="st">"D"</span>),<span class="dv">200</span>,<span class="dt">replace =</span> <span class="ot">TRUE</span>),<span class="dt">stringsAsFactors =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb71-5" title="5"></a>
<a class="sourceLine" id="cb71-6" title="6"><span class="co">#make data with missing values</span></a>
<a class="sourceLine" id="cb71-7" title="7">rawDataWithMissing&lt;-rawData</a>
<a class="sourceLine" id="cb71-8" title="8"></a>
<a class="sourceLine" id="cb71-9" title="9"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Random">set.seed</a></span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb71-10" title="10">temp1&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sample">sample</a></span>(<span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/nrow">ncol</a></span>(rawDataWithMissing),<span class="dv">200</span>,<span class="dt">replace=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb71-11" title="11">temp2&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sample">sample</a></span>(<span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/nrow">nrow</a></span>(rawDataWithMissing),<span class="dv">200</span>,<span class="dt">replace=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb71-12" title="12"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(temp1)) {</a>
<a class="sourceLine" id="cb71-13" title="13">  rawDataWithMissing[temp2[i],temp1[i]]&lt;-<span class="ot">NA</span></a>
<a class="sourceLine" id="cb71-14" title="14">}</a></code></pre></div>
</div>
<div id="notes" class="section level2">
<h2 class="hasAnchor">
<a href="#notes" class="anchor"></a>Notes</h2>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb72-1" title="1"><span class="co">#Making formula. Using () to print at the same time</span></a>
<a class="sourceLine" id="cb72-2" title="2"><span class="co">#(formulaForModel&lt;-as.formula(paste0(outVar,"~",paste(varForTable1, collapse=" + "))))</span></a></code></pre></div>
<p>##Logistic regression: Model, Table, and Figure</p>
<div id="model-and-table" class="section level3">
<h3 class="hasAnchor">
<a href="#model-and-table" class="anchor"></a>Model and Table</h3>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb73-1" title="1">outVar=<span class="st">"FeatureYN1"</span></a>
<a class="sourceLine" id="cb73-2" title="2">varForTable=<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"Feature1"</span>, <span class="st">"Feature2"</span>,<span class="st">"Feature3"</span>,<span class="st">"FeatureCategory1"</span>)</a>
<a class="sourceLine" id="cb73-3" title="3"></a>
<a class="sourceLine" id="cb73-4" title="4"><span class="kw">nonLinearTest</span>(rawData,outVar,varForTable,<span class="dt">modelType =</span><span class="st">"lrm"</span>,<span class="dt">returnKable=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<table class="table">
<caption>Non-linear Test for continuous variables</caption>
<thead><tr class="header">
<th align="left">Outcome</th>
<th align="left">X</th>
<th align="left">Formula</th>
<th align="left">P (Variable)</th>
<th align="left">P ( Nonlinear)</th>
<th align="left">P (TOTAL)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">FeatureYN1</td>
<td align="left">Feature1</td>
<td align="left">FeatureYN1 ~ rcs(Feature1, 3)</td>
<td align="left">0.044</td>
<td align="left">0.127</td>
<td align="left">0.044</td>
</tr>
<tr class="even">
<td align="left">FeatureYN1</td>
<td align="left">Feature2</td>
<td align="left">FeatureYN1 ~ rcs(Feature2, 3)</td>
<td align="left">0.133</td>
<td align="left">0.119</td>
<td align="left">0.133</td>
</tr>
<tr class="odd">
<td align="left">FeatureYN1</td>
<td align="left">Feature3</td>
<td align="left">FeatureYN1 ~ rcs(Feature3, 3)</td>
<td align="left">0.881</td>
<td align="left">0.649</td>
<td align="left">0.881</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb74-1" title="1"><span class="kw">modelTable</span>(rawData,<span class="dt">outVars=</span><span class="st">"FeatureYN1"</span>,<span class="dt">interestedVars=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"Feature1"</span>),<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"Feature2"</span>,<span class="st">"FeatureCategory1"</span>)),<span class="dt">adjVars=</span><span class="st">"Feature3"</span>)</a></code></pre></div>
<pre><code>                                                Formula           Event          InterestedVar Effect (One Unit)      P Odds Ratio (One Unit) OR (Lower 95%) OR (Upper 95%) Value (25% Quantile) Value (75% Quantile) Value Diff (75%-25%) Odds Ratio (Diff: 75%-25%) OR (Diff, Lower 95%) OR (Diff, Upper 95%)</code></pre>
<p>1 lrm (FeatureYN1 ~ Feature1 + Feature3) 1(100) : 0(100) Feature1 0.277 0.0391 1.319 1.014 1.716 -0.771 0.744 1.516 1.521 1.021 2.267 2 lrm (FeatureYN1 ~ Feature2 + FeatureCategory1 + Feature3) 1(100) : 0(100) Feature2 -0.212 0.1722 0.809 0.597 1.097 -0.599 0.66 1.259 0.766 0.522 1.123 3 lrm (FeatureYN1 ~ Feature2 + FeatureCategory1 + Feature3) 1(100) : 0(100) FeatureCategory1 - F:E -0.265 0.3549 0.767 0.437 1.346</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb76-1" title="1"><span class="kw">modelTable</span>(rawData,<span class="dt">outVars=</span><span class="st">"FeatureYN1"</span>,<span class="dt">interestedVars=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"Feature1"</span>,<span class="st">"Feature2"</span>,<span class="st">"FeatureCategory1"</span>),<span class="dt">adjVars=</span><span class="st">"Feature3"</span>)</a></code></pre></div>
<pre><code>                                     Formula           Event          InterestedVar Effect (One Unit)      P Odds Ratio (One Unit) OR (Lower 95%) OR (Upper 95%) Value (25% Quantile) Value (75% Quantile) Value Diff (75%-25%) Odds Ratio (Diff: 75%-25%) OR (Diff, Lower 95%) OR (Diff, Upper 95%)</code></pre>
<p>1 lrm (FeatureYN1 ~ Feature1 + Feature3) 1(100) : 0(100) Feature1 0.277 0.0391 1.319 1.014 1.716 -0.771 0.744 1.516 1.521 1.021 2.267 2 lrm (FeatureYN1 ~ Feature2 + Feature3) 1(100) : 0(100) Feature2 -0.204 0.1867 0.815 0.602 1.104 -0.599 0.66 1.259 0.773 0.528 1.132 3 lrm (FeatureYN1 ~ FeatureCategory1 + Feature3) 1(100) : 0(100) FeatureCategory1 - F:E -0.244 0.3922 0.784 0.448 1.370</p>
</div>
<div id="figure" class="section level3">
<h3 class="hasAnchor">
<a href="#figure" class="anchor"></a>Figure</h3>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb78-1" title="1">outVar=<span class="st">"FeatureYN1"</span></a>
<a class="sourceLine" id="cb78-2" title="2">varForTable=<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"Feature1"</span>, <span class="st">"Feature2"</span>,<span class="st">"Feature3"</span>,<span class="st">"FeatureCategory1"</span>)</a>
<a class="sourceLine" id="cb78-3" title="3"></a>
<a class="sourceLine" id="cb78-4" title="4"><span class="kw">nonLinearTest</span>(rawData,outVar,varForTable,<span class="dt">modelType =</span><span class="st">"lrm"</span>)</a></code></pre></div>
<pre><code>     Outcome      X          Formula                         P (Variable) P ( Nonlinear) P (TOTAL)
[1,] "FeatureYN1" "Feature1" "FeatureYN1 ~ rcs(Feature1, 3)" "0.044"      "0.127"        "0.044"  
[2,] "FeatureYN1" "Feature2" "FeatureYN1 ~ rcs(Feature2, 3)" "0.133"      "0.119"        "0.133"  
[3,] "FeatureYN1" "Feature3" "FeatureYN1 ~ rcs(Feature3, 3)" "0.881"      "0.649"        "0.881"  </code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb80-1" title="1"><span class="co">#None of them has non-linear term. But will add nonlinear in the model as an example</span></a>
<a class="sourceLine" id="cb80-2" title="2"><span class="co">#(formulaForModel&lt;-as.formula(paste0(outVar,"~",paste(varForTable, collapse=" + "))))</span></a>
<a class="sourceLine" id="cb80-3" title="3">formulaForModel&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/formula">as.formula</a></span>(FeatureYN1<span class="op">~</span><span class="kw"><a href="https://www.rdocumentation.org/packages/rms/topics/rms.trans">rcs</a></span>(Feature1,<span class="dv">3</span>)<span class="op">+</span>Feature2<span class="op">+</span>Feature3<span class="op">+</span>FeatureCategory1)</a>
<a class="sourceLine" id="cb80-4" title="4">dataForModel&lt;-rawData[,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(outVar,varForTable)]</a>
<a class="sourceLine" id="cb80-5" title="5">ddist &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/rms/topics/datadist">datadist</a></span>(dataForModel)</a>
<a class="sourceLine" id="cb80-6" title="6"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/options">options</a></span>(<span class="dt">datadist=</span><span class="st">'ddist'</span>)</a>
<a class="sourceLine" id="cb80-7" title="7"></a>
<a class="sourceLine" id="cb80-8" title="8">modelResult &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/rms/topics/lrm">lrm</a></span>(formulaForModel, <span class="dt">data=</span>rawData)</a>
<a class="sourceLine" id="cb80-9" title="9"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(modelResult)</a></code></pre></div>
<pre><code>Logistic Regression Model
 
 lrm(formula = formulaForModel, data = rawData)
 
                      Model Likelihood     Discrimination    Rank Discrim.    
                         Ratio Test           Indexes           Indexes       
 Obs           200    LR chi2     10.06    R2       0.065    C       0.600    
  0            100    d.f.            5    g        0.508    Dxy     0.199    
  1            100    Pr(&gt; chi2) 0.0737    gr       1.662    gamma   0.199    
 max |deriv| 1e-12                         gp       0.120    tau-a   0.100    
                                           Brier    0.238                     
 
                    Coef    S.E.   Wald Z Pr(&gt;|Z|)
 Intercept           0.5604 0.3297  1.70  0.0892  
 Feature1            0.7432 0.3274  2.27  0.0232  
 Feature1'          -0.5401 0.3520 -1.53  0.1250  
 Feature2           -0.2257 0.1574 -1.43  0.1514  
 Feature3            0.0406 0.1512  0.27  0.7885  
 FeatureCategory1=F -0.3259 0.2952 -1.10  0.2696  
 </code></pre>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb82-1" title="1"><span class="co">#showOddsRatio2(modelResult)</span></a>
<a class="sourceLine" id="cb82-2" title="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/rms/topics/Predict">Predict</a></span>(modelResult))</a></code></pre></div>
<p><img src="EasierStatisticModels_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb83-1" title="1"><span class="co">#extract p value from results</span></a>
<a class="sourceLine" id="cb83-2" title="2"><span class="co">#http://r.789695.n4.nabble.com/Extracting-P-values-from-the-lrm-function-in-the-rms-library-td2260999.html</span></a>
<a class="sourceLine" id="cb83-3" title="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Normal">pnorm</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/MathFun">abs</a></span>(modelResult<span class="op">$</span>coef<span class="op">/</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/MathFun">sqrt</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/diag">diag</a></span>(modelResult<span class="op">$</span>var))),<span class="dt">lower.tail=</span>F)<span class="op">*</span><span class="dv">2</span> </a></code></pre></div>
<pre><code>         Intercept           Feature1          Feature1'           Feature2           Feature3 FeatureCategory1=F 
        0.08917042         0.02318681         0.12499723         0.15142348         0.78853165         0.26959283 </code></pre>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb85-1" title="1"><span class="co">#more plot</span></a>
<a class="sourceLine" id="cb85-2" title="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/rms/topics/Predict">Predict</a></span>(modelResult,<span class="dt">fun=</span>plogis))</a></code></pre></div>
<p><img src="EasierStatisticModels_files/figure-html/unnamed-chunk-5-2.png" width="700"></p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb86-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/rms/topics/Predict">Predict</a></span>(modelResult,Feature1,<span class="dt">fun=</span>plogis))</a></code></pre></div>
<p><img src="EasierStatisticModels_files/figure-html/unnamed-chunk-5-3.png" width="700"></p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb87-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/rms/topics/Predict">Predict</a></span>(modelResult,<span class="dt">Feature1=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sort">sort</a></span>(dataForModel<span class="op">$</span>Feature1),<span class="dt">fun=</span>plogis))</a></code></pre></div>
<p><img src="EasierStatisticModels_files/figure-html/unnamed-chunk-5-4.png" width="700"></p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb88-1" title="1">temp=<span class="kw"><a href="https://www.rdocumentation.org/packages/rms/topics/Predict">Predict</a></span>(modelResult,<span class="dt">Feature1=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sort">sort</a></span>(dataForModel<span class="op">$</span>Feature1),<span class="dt">fun=</span>plogis)</a>
<a class="sourceLine" id="cb88-2" title="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/str">str</a></span>(temp)</a></code></pre></div>
<pre><code>Classes 'Predict' and 'data.frame': 200 obs. of  7 variables:
 $ Feature1        : num  -2.56 -2.36 -2.35 -2.33 -2.28 ...
 $ Feature2        : num  -0.0158 -0.0158 -0.0158 -0.0158 -0.0158 ...
 $ Feature3        : num  0.185 0.185 0.185 0.185 0.185 ...
 $ FeatureCategory1: Factor w/ 2 levels "E","F": 1 1 1 1 1 1 1 1 1 1 ...
 $ yhat            : num  0.209 0.235 0.236 0.238 0.245 ...
 $ lower           : num  0.0714 0.092 0.0932 0.0947 0.1004 ...
 $ upper           : num  0.475 0.482 0.483 0.483 0.485 ...
 - attr(*, "out.attrs")=List of 2
  ..$ dim     : Named int  200 1 1 1
  .. ..- attr(*, "names")= chr  "Feature1" "Feature2" "Feature3" "FeatureCategory1"
  ..$ dimnames:List of 4
  .. ..$ Feature1        : chr  "Feature1=-2.562726" "Feature1=-2.356756" "Feature1=-2.345888" "Feature1=-2.332444" ...
  .. ..$ Feature2        : chr "Feature2=-0.01576"
  .. ..$ Feature3        : chr "Feature3=0.1848"
  .. ..$ FeatureCategory1: chr "FeatureCategory1=E"
 - attr(*, "info")=List of 11
  ..$ varying     : chr "Feature1"
  ..$ adjust      : chr "Feature2=-0.01576 Feature3=0.1848 FeatureCategory1=E "
  ..$ Design      :List of 3
  .. ..$ label      : Named chr  "Feature1" "Feature2" "Feature3" "FeatureCategory1"
  .. .. ..- attr(*, "names")= chr  "Feature1" "Feature2" "Feature3" "FeatureCategory1"
  .. ..$ units      : Named chr  "" "" "" ""
  .. .. ..- attr(*, "names")= chr  "Feature1" "Feature2" "Feature3" "FeatureCategory1"
  .. ..$ assume.code: Named int  4 1 1 5
  .. .. ..- attr(*, "names")= chr  "Feature1" "Feature2" "Feature3" "FeatureCategory1"
  ..$ ylabPlotmath: chr ""
  ..$ ylabhtml    : chr ""
  ..$ ylab        : chr ""
  ..$ yunits      : NULL
  ..$ ref.zero    : logi FALSE
  ..$ adj.zero    : logi FALSE
  ..$ time        : NULL
  ..$ conf.int    : num 0.95</code></pre>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb90-1" title="1">p=rms<span class="op">:::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/rms/topics/ggplot.Predict">ggplot.Predict</a></span>(temp,<span class="dt">ylim=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">0</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb90-2" title="2"><span class="co">#same thing</span></a>
<a class="sourceLine" id="cb90-3" title="3"><span class="co">#p=ggplot(temp,aes(x=Feature1,y=yhat),ylim=c(0,1))+geom_line()+geom_ribbon(aes(ymin=lower,ymax=upper),alpha=0.05)</span></a>
<a class="sourceLine" id="cb90-4" title="4"></a>
<a class="sourceLine" id="cb90-5" title="5">p<span class="op">+</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x=</span>Feature1,<span class="dt">y=</span>FeatureYN1),<span class="dt">data=</span>dataForModel)</a></code></pre></div>
<p><img src="EasierStatisticModels_files/figure-html/unnamed-chunk-5-5.png" width="700"></p>
<p>##Logistic regression: ROC curve and best cutoff</p>
</div>
<div id="simple-one-variable-model" class="section level3">
<h3 class="hasAnchor">
<a href="#simple-one-variable-model" class="anchor"></a>Simple one variable model</h3>
<p><a href="https://stackoverflow.com/questions/16347507/obtaining-threshold-values-from-a-roc-curve" class="uri">https://stackoverflow.com/questions/16347507/obtaining-threshold-values-from-a-roc-curve</a></p>
<p>Or using OptimalCutpoints package which provides many algorithms to find an optimal thresholds. Or coords function in pROC package</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb91-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/source">source</a></span>(<span class="st">"D:</span><span class="ch">\\</span><span class="st">source</span><span class="ch">\\</span><span class="st">r_cqs</span><span class="ch">\\</span><span class="st">myPkg</span><span class="ch">\\</span><span class="st">R</span><span class="ch">\\</span><span class="st">logisticRegressionAndRocFunctions.R"</span>)</a>
<a class="sourceLine" id="cb91-2" title="2"></a>
<a class="sourceLine" id="cb91-3" title="3">dataForModel=rawData</a>
<a class="sourceLine" id="cb91-4" title="4">temp=<span class="kw">makeModelAndTable</span>(dataForModel,<span class="dt">labelVar=</span><span class="st">"FeatureYN1"</span>,<span class="dt">xVar=</span><span class="st">"Feature1"</span>)</a></code></pre></div>
<p><img src="EasierStatisticModels_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb92-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/knitr/topics/kable">kable</a></span>(temp)</a></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">cut</th>
<th align="right">sens</th>
<th align="right">spec</th>
<th align="right">ppv</th>
<th align="right">npv</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">-1.44327239102318</td>
<td align="right">0.95</td>
<td align="right">0.15</td>
<td align="right">0.5300000</td>
<td align="right">0.7500000</td>
</tr>
<tr class="even">
<td align="left">-0.771357770606852</td>
<td align="right">0.83</td>
<td align="right">0.33</td>
<td align="right">0.5500000</td>
<td align="right">0.6600000</td>
</tr>
<tr class="odd">
<td align="left">-0.0396971579882457</td>
<td align="right">0.53</td>
<td align="right">0.53</td>
<td align="right">0.5300000</td>
<td align="right">0.5300000</td>
</tr>
<tr class="even">
<td align="left">0.744156606775947</td>
<td align="right">0.26</td>
<td align="right">0.76</td>
<td align="right">0.5200000</td>
<td align="right">0.5100000</td>
</tr>
<tr class="odd">
<td align="left">1.31169924528837</td>
<td align="right">0.13</td>
<td align="right">0.93</td>
<td align="right">0.6500000</td>
<td align="right">0.5200000</td>
</tr>
<tr class="even">
<td align="left">Max (Sens+Spec): -0.803291122937887</td>
<td align="right">0.86</td>
<td align="right">0.33</td>
<td align="right">0.5620915</td>
<td align="right">0.7021277</td>
</tr>
<tr class="odd">
<td align="left">Max Spec when Sens&gt;=0.8: -0.667217415388882</td>
<td align="right">0.80</td>
<td align="right">0.35</td>
<td align="right">0.5517241</td>
<td align="right">0.6363636</td>
</tr>
</tbody>
</table>
</div>
<div id="complicated-model" class="section level3">
<h3 class="hasAnchor">
<a href="#complicated-model" class="anchor"></a>Complicated Model</h3>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb93-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/source">source</a></span>(<span class="st">"D:</span><span class="ch">\\</span><span class="st">source</span><span class="ch">\\</span><span class="st">r_cqs</span><span class="ch">\\</span><span class="st">myPkg</span><span class="ch">\\</span><span class="st">R</span><span class="ch">\\</span><span class="st">logisticRegressionAndRocFunctions.R"</span>)</a>
<a class="sourceLine" id="cb93-2" title="2"></a>
<a class="sourceLine" id="cb93-3" title="3">otherVar=<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"FeatureYN1"</span>)</a>
<a class="sourceLine" id="cb93-4" title="4">xVarList&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(</a>
<a class="sourceLine" id="cb93-5" title="5">        <span class="st">"Feature1"</span>,</a>
<a class="sourceLine" id="cb93-6" title="6">        <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"Feature2"</span>,<span class="st">"FeatureCategory1"</span>)</a>
<a class="sourceLine" id="cb93-7" title="7">)</a>
<a class="sourceLine" id="cb93-8" title="8">otherVar=<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"Feature3"</span>) <span class="co">#like age and gender</span></a>
<a class="sourceLine" id="cb93-9" title="9"><span class="kw">plotModelRocAdjusted</span>(dataForModel,</a>
<a class="sourceLine" id="cb93-10" title="10">        <span class="dt">xVarList=</span>xVarList,<span class="dt">outVar=</span>outVar,<span class="dt">otherVar=</span>otherVar,</a>
<a class="sourceLine" id="cb93-11" title="11">        <span class="dt">verbose=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## Logistic Regression Model
##  
##  lrm(formula = formulaForModel, data = dataForModel, x = TRUE, 
##      y = TRUE)
##  
##                       Model Likelihood     Discrimination    Rank Discrim.    
##                          Ratio Test           Indexes           Indexes       
##  Obs           200    LR chi2      4.45    R2       0.029    C       0.582    
##   0            100    d.f.            2    g        0.343    Dxy     0.163    
##   1            100    Pr(&gt; chi2) 0.1083    gr       1.409    gamma   0.163    
##  max |deriv| 1e-09                         gp       0.084    tau-a   0.082    
##                                            Brier    0.244                     
##  
##            Coef   S.E.   Wald Z Pr(&gt;|Z|)
##  Intercept 0.0064 0.1439 0.04   0.9647  
##  Feature1  0.2769 0.1342 2.06   0.0391  
##  Feature3  0.0257 0.1491 0.17   0.8632  
## </code></pre>
<pre><code>## Setting levels: control = 0, case = 1</code></pre>
<pre><code>## Setting direction: controls &lt; cases</code></pre>
<pre><code>## Logistic Regression Model
##  
##  lrm(formula = formulaForModel, data = dataForModel, x = TRUE, 
##      y = TRUE)
##  
##                       Model Likelihood     Discrimination    Rank Discrim.    
##                          Ratio Test           Indexes           Indexes       
##  Obs           200    LR chi2      2.67    R2       0.018    C       0.555    
##   0            100    d.f.            3    g        0.264    Dxy     0.109    
##   1            100    Pr(&gt; chi2) 0.4453    gr       1.303    gamma   0.109    
##  max |deriv| 2e-11                         gp       0.065    tau-a   0.055    
##                                            Brier    0.247                     
##  
##                     Coef    S.E.   Wald Z Pr(&gt;|Z|)
##  Intercept           0.1075 0.1923  0.56  0.5763  
##  Feature2           -0.2120 0.1553 -1.37  0.1722  
##  FeatureCategory1=F -0.2653 0.2868 -0.93  0.3549  
##  Feature3            0.0247 0.1487  0.17  0.8681  
## </code></pre>
<pre><code>## Setting levels: control = 0, case = 1
## Setting direction: controls &lt; cases</code></pre>
<pre><code>## Logistic Regression Model
##  
##  lrm(formula = formulaForModel, data = dataForModel, x = TRUE, 
##      y = TRUE)
##  
##                       Model Likelihood     Discrimination    Rank Discrim.    
##                          Ratio Test           Indexes           Indexes       
##  Obs           200    LR chi2      7.65    R2       0.050    C       0.599    
##   0            100    d.f.            4    g        0.453    Dxy     0.198    
##   1            100    Pr(&gt; chi2) 0.1052    gr       1.573    gamma   0.198    
##  max |deriv| 8e-08                         gp       0.109    tau-a   0.099    
##                                            Brier    0.241                     
##  
##                     Coef    S.E.   Wald Z Pr(&gt;|Z|)
##  Intercept           0.1552 0.1961  0.79  0.4288  
##  Feature1            0.3006 0.1376  2.19  0.0289  
##  Feature2           -0.2181 0.1568 -1.39  0.1643  
##  FeatureCategory1=F -0.3481 0.2935 -1.19  0.2357  
##  Feature3            0.0181 0.1501  0.12  0.9039  
## </code></pre>
<pre><code>## Setting levels: control = 0, case = 1
## Setting direction: controls &lt; cases</code></pre>
<pre><code>## Warning in coords.roc(resultRoc[[length(resultRoc)]], "best"): An upcoming version of pROC will set the 'transpose' argument to FALSE by default. Set transpose = TRUE explicitly to keep the current behavior, or transpose = FALSE to adopt the new one and silence this warning. Type help(coords_transpose) for additional information.</code></pre>
<p><img src="EasierStatisticModels_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction  0  1
##          0 22  4
##          1 78 96
##                                           
##                Accuracy : 0.59            
##                  95% CI : (0.5184, 0.6589)
##     No Information Rate : 0.5             
##     P-Value [Acc &gt; NIR] : 0.006565        
##                                           
##                   Kappa : 0.18            
##                                           
##  Mcnemar's Test P-Value : 7.536e-16       
##                                           
##             Sensitivity : 0.9600          
##             Specificity : 0.2200          
##          Pos Pred Value : 0.5517          
##          Neg Pred Value : 0.8462          
##              Prevalence : 0.5000          
##          Detection Rate : 0.4800          
##    Detection Prevalence : 0.8700          
##       Balanced Accuracy : 0.5900          
##                                           
##        'Positive' Class : 1               
## </code></pre>
</div>
</div>
<div id="linear-regression" class="section level2">
<h2 class="hasAnchor">
<a href="#linear-regression" class="anchor"></a>Linear regression</h2>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb103-1" title="1">outVar=<span class="st">"Feature1"</span></a>
<a class="sourceLine" id="cb103-2" title="2">varForTable=<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"FeatureYN1"</span>, <span class="st">"Feature2"</span>,<span class="st">"Feature3"</span>,<span class="st">"FeatureCategory1"</span>)</a>
<a class="sourceLine" id="cb103-3" title="3"></a>
<a class="sourceLine" id="cb103-4" title="4"><span class="kw">nonLinearTest</span>(rawData,outVar,varForTable,<span class="dt">modelType =</span><span class="st">"ols"</span>)</a></code></pre></div>
<pre><code>     Outcome    X          Formula                       P (Variable) P ( Nonlinear) P (TOTAL)
[1,] "Feature1" "Feature2" "Feature1 ~ rcs(Feature2, 3)" "0.624"      "0.332"        "0.624"  
[2,] "Feature1" "Feature3" "Feature1 ~ rcs(Feature3, 3)" "0.578"      "0.318"        "0.578"  </code></pre>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb105-1" title="1"><span class="kw">modelTable</span>(rawData,<span class="dt">outVars=</span><span class="st">"Feature1"</span>,<span class="dt">interestedVars=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"FeatureYN1"</span>),<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"Feature2"</span>,<span class="st">"FeatureCategory1"</span>)),<span class="dt">adjVars=</span><span class="st">"Feature3"</span>,<span class="dt">modelType =</span><span class="st">"ols"</span>)</a></code></pre></div>
<pre><code>                                                  Formula          InterestedVar      P Effect (One Unit) Effect (Lower 95%) Effect (Upper 95%) Value (25% Quantile) Value (75% Quantile) Value Diff (75%-25%) Effect (Diff: 75%-25%) Effect (Diff, Lower 95%) Effect (Diff, Upper 95%)
1                  ols (Feature1 ~ FeatureYN1 + Feature3)       FeatureYN1 - 1:0 0.0363             0.321              0.019              0.624                                                                                                                                        
2 ols (Feature1 ~ Feature2 + FeatureCategory1 + Feature3)               Feature2 0.9634             0.004             -0.161              0.169               -0.599                 0.66                1.259                  0.005                   -0.202                    0.212
3 ols (Feature1 ~ Feature2 + FeatureCategory1 + Feature3) FeatureCategory1 - F:E 0.1151             0.245             -0.062              0.552                                                                                                                                        </code></pre>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb107-1" title="1"><span class="kw">modelTable</span>(rawData,<span class="dt">outVars=</span><span class="st">"Feature1"</span>,<span class="dt">interestedVars=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"FeatureYN1"</span>,<span class="st">"Feature2"</span>,<span class="st">"FeatureCategory1"</span>),<span class="dt">adjVars=</span><span class="st">"Feature3"</span>,<span class="dt">modelType =</span><span class="st">"ols"</span>)</a></code></pre></div>
<pre><code>                                       Formula          InterestedVar      P Effect (One Unit) Effect (Lower 95%) Effect (Upper 95%) Value (25% Quantile) Value (75% Quantile) Value Diff (75%-25%) Effect (Diff: 75%-25%) Effect (Diff, Lower 95%) Effect (Diff, Upper 95%)
1       ols (Feature1 ~ FeatureYN1 + Feature3)       FeatureYN1 - 1:0 0.0363             0.321              0.019              0.624                                                                                                                                        
2         ols (Feature1 ~ Feature2 + Feature3)               Feature2  0.976            -0.003             -0.168              0.163               -0.599                 0.66                1.259                 -0.003                   -0.211                    0.205
3 ols (Feature1 ~ FeatureCategory1 + Feature3) FeatureCategory1 - F:E 0.1143             0.245             -0.061              0.551                                                                                                                                        </code></pre>
</div>
<div id="survival-model" class="section level2">
<h2 class="hasAnchor">
<a href="#survival-model" class="anchor"></a>Survival Model</h2>
<div id="km-curves" class="section level3">
<h3 class="hasAnchor">
<a href="#km-curves" class="anchor"></a>KM Curves</h3>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb109-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/source">source</a></span>(<span class="st">"D:</span><span class="ch">\\</span><span class="st">source</span><span class="ch">\\</span><span class="st">r_cqs</span><span class="ch">\\</span><span class="st">myPkg</span><span class="ch">\\</span><span class="st">R</span><span class="ch">\\</span><span class="st">survivalCurveTable.R"</span>)</a>
<a class="sourceLine" id="cb109-2" title="2"></a>
<a class="sourceLine" id="cb109-3" title="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Random">set.seed</a></span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb109-4" title="4">rawData<span class="op">$</span>FeatureAbs1&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/MathFun">abs</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Normal">rnorm</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/nrow">nrow</a></span>(rawData))<span class="op">*</span><span class="dv">100</span>)</a>
<a class="sourceLine" id="cb109-5" title="5"></a>
<a class="sourceLine" id="cb109-6" title="6">fit1 &lt;-<span class="st"> </span><span class="kw">survfit</span>(<span class="kw">Surv</span>(FeatureAbs1, FeatureYN1) <span class="op">~</span><span class="st"> </span>FeatureCategory1,<span class="dt">data=</span>rawData)</a>
<a class="sourceLine" id="cb109-7" title="7"><span class="kw">kmplot</span>(fit1,<span class="dt">col.surv=</span><span class="dv">1</span><span class="op">:</span><span class="dv">2</span>,<span class="dt">lwd.surv=</span><span class="dv">3</span>,<span class="dt">grid=</span><span class="ot">FALSE</span>,<span class="dt">las=</span><span class="dv">1</span>,<span class="dt">pValue=</span><span class="ot">TRUE</span>,<span class="dt">cex.axis=</span><span class="fl">1.2</span>,<span class="dt">loc.legend=</span><span class="st">"topright"</span>)</a></code></pre></div>
<p><img src="EasierStatisticModels_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb110-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(fit1)</a></code></pre></div>
<pre><code>## Call: survfit(formula = Surv(FeatureAbs1, FeatureYN1) ~ FeatureCategory1, 
##     data = rawData)
## 
##                      n events median 0.95LCL 0.95UCL
## FeatureCategory1=E 110     58    106    99.4     131
## FeatureCategory1=F  90     42    119    92.2     146</code></pre>
</div>
<div id="model" class="section level3">
<h3 class="hasAnchor">
<a href="#model" class="anchor"></a>Model</h3>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb112-1" title="1">ddist &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/rms/topics/datadist">datadist</a></span>(rawData)</a>
<a class="sourceLine" id="cb112-2" title="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/options">options</a></span>(<span class="dt">datadist=</span><span class="st">'ddist'</span>)</a>
<a class="sourceLine" id="cb112-3" title="3"></a>
<a class="sourceLine" id="cb112-4" title="4">varForSurvivalModel1=<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"FeatureCategory1"</span>,<span class="st">"Feature2"</span>)</a>
<a class="sourceLine" id="cb112-5" title="5">(fmla&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/formula">as.formula</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste0</a></span>(<span class="st">"Surv(FeatureAbs1, FeatureYN1)~"</span>,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste0</a></span>(varForSurvivalModel1,<span class="dt">collapse=</span><span class="st">"+"</span>))))</a></code></pre></div>
<pre><code>## Surv(FeatureAbs1, FeatureYN1) ~ FeatureCategory1 + Feature2</code></pre>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb114-1" title="1">fmi=<span class="kw"><a href="https://www.rdocumentation.org/packages/rms/topics/cph">cph</a></span>(fmla,<span class="dt">data=</span>rawData)</a>
<a class="sourceLine" id="cb114-2" title="2"></a>
<a class="sourceLine" id="cb114-3" title="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(fmi)</a></code></pre></div>
<pre><code>## Cox Proportional Hazards Model
##  
##  cph(formula = fmla, data = rawData)
##  
##                       Model Tests       Discrimination    
##                                            Indexes        
##  Obs        200    LR chi2      3.73    R2       0.019    
##  Events     100    d.f.            2    Dxy      0.063    
##  Center -0.0244    Pr(&gt; chi2) 0.1547    g        0.221    
##                    Score chi2   3.81    gr       1.247    
##                    Pr(&gt; chi2) 0.1491                      
##  
##                     Coef    S.E.   Wald Z Pr(&gt;|Z|)
##  FeatureCategory1=F -0.0750 0.2052 -0.37  0.7148  
##  Feature2           -0.2084 0.1093 -1.91  0.0566  
## </code></pre>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb116-1" title="1"><span class="co">#showOddsRatio2(fmi)</span></a>
<a class="sourceLine" id="cb116-2" title="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/rms/topics/Predict">Predict</a></span>(fmi))</a></code></pre></div>
<p><img src="EasierStatisticModels_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<p>##Missing values</p>
</div>
<div id="table-0-missing-data-describe" class="section level3">
<h3 class="hasAnchor">
<a href="#table-0-missing-data-describe" class="anchor"></a>Table 0: Missing Data Describe</h3>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb117-1" title="1">varForTable=<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/colnames">colnames</a></span>(rawDataWithMissing)</a>
<a class="sourceLine" id="cb117-2" title="2">s=<span class="kw">describe</span>(rawDataWithMissing[,varForTable])</a>
<a class="sourceLine" id="cb117-3" title="3"><span class="kw">html</span>(s, <span class="dt">exclude1=</span><span class="ot">FALSE</span>,  <span class="dt">what=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">'%'</span>),<span class="dt">digits=</span><span class="dv">3</span>, <span class="dt">prmsd=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## Warning in png(file, width = 1 + k * w, height = h): 'width=13, height=13' are unlikely values in pixels</code></pre>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<script type="text/javascript">
<!--
    function expand_collapse(id) {
       var e = document.getElementById(id);
       var f = document.getElementById(id+"_earrows");
       if(e.style.display == 'none'){
          e.style.display = 'block';
          f.innerHTML = '&#9650';
       }
       else {
          e.style.display = 'none';
          f.innerHTML = '&#9660';
       }
    }
//-->
</script><style>
.earrows {color:silver;font-size:11px;}

fcap {
 font-family: Verdana;
 font-size: 12px;
 color: MidnightBlue
 }

smg {
 font-family: Verdana;
 font-size: 10px;
 color: &#808080;
}

hr.thinhr { margin-top: 0.15em; margin-bottom: 0.15em; }

span.xscript {
position: relative;
}
span.xscript sub {
position: absolute;
left: 0.1em;
bottom: -1ex;
}
</style>
<font color="MidnightBlue"><div align="center"><span style="font-weight:bold">rawDataWithMissing[, varForTable] <br><br> 13  Variables â€ƒ 200  Observations</span></div></font> <hr class="thinhr">
<span style="font-weight:bold">Feature1</span><div style="float: right; text-align: right;"><img src="data:image/png;base64,%0D%0AiVBORw0KGgoAAAANSUhEUgAAAJcAAAANCAMAAACTvAxuAAAACVBMVEUAAADMzMz////1iUV5AAAAnElEQVQ4jeVTWw7AIAgr3v/Qy0YVnJhg3I8ZyZyWV8UUsmnAjnueV/KGKDgE0+553krsObxwm7qcN97+lBccFx4egJii+7yWpac0eDReQkzRz/QY34to+3kr/MJ5cW8zXp3fMby6EqyM1i5jxRgXW2rN83n5odvLDCyytOIca4Pu/gzqKD2B0oSkSy0krxYjkDDLEa9XJ1QGDbK/AH82CawuWL9lAAAAAElFTkSuQmCC" alt="image"></div> <pre style="font-size:85%;">
        n  missing distinct     Info     Mean      Gmd      .05      .10      .25 
      191        9      191        1 -0.04295    1.233 -1.92497 -1.45947 -0.75786 
      .50      .75      .90      .95 
 -0.04462  0.69177  1.27341  1.81512 
 </pre>
 <style>
 .hmisctable987447 {
 border: none;
 font-size: 85%;
 }
 .hmisctable987447 td {
 text-align: right;
 padding: 0 1ex 0 1ex;
 }
 .hmisctable987447 th {
 color: Black;
 text-align: center;
 padding: 0 1ex 0 1ex;
 font-weight: bold;
 }
 </style>
<table class="table hmisctable987447">
<tr>
<td>
<font color="MidnightBlue">lowest</font>Â :</td>
<td>-2.562726</td>
<td>-2.356756</td>
<td>-2.345888</td>
<td>-2.332444</td>
<td>-2.284099</td>
</tr>
<tr>
<td>
<font color="MidnightBlue">highest</font>:</td>
<td> 2.485311</td>
<td> 2.548370</td>
<td> 2.647589</td>
<td> 2.682030</td>
<td> 3.262158</td>
</tr>
</table>
<hr class="thinhr">
<span style="font-weight:bold">Feature2</span><div style="float: right; text-align: right;"><img src="data:image/png;base64,%0D%0AiVBORw0KGgoAAAANSUhEUgAAAJcAAAANCAMAAACTvAxuAAAACVBMVEUAAADMzMz////1iUV5AAAAo0lEQVQ4je2TjQqAIAyET9//oQN17sxZmiMIGoTzb/u6OgSHAKx0r2R0CMBKBycmS27gWF1/rgmajqvDeJEL0guU+XE9d4xYD5QVP3auXLbpul6iSFIpPyJY0gskIF1qhbzV73r/VAagL4XKdAo6xgmiTj7NpU0NLt7TrkIw5houWVxW5/ou+pvIUa3jHbEOBlfuWfxULjQGkhV/rlAHw61pdgB24woRcU8YxgAAAABJRU5ErkJggg==" alt="image"></div> <pre style="font-size:85%;">
        n  missing distinct     Info     Mean      Gmd      .05      .10      .25 
      190       10      190        1 -0.06921    1.038 -1.61232 -1.23814 -0.60576 
      .50      .75      .90      .95 
 -0.04542  0.59979  1.08304  1.34243 
 </pre>
 <style>
 .hmisctable223360 {
 border: none;
 font-size: 85%;
 }
 .hmisctable223360 td {
 text-align: right;
 padding: 0 1ex 0 1ex;
 }
 .hmisctable223360 th {
 color: Black;
 text-align: center;
 padding: 0 1ex 0 1ex;
 font-weight: bold;
 }
 </style>
<table class="table hmisctable223360">
<tr>
<td>
<font color="MidnightBlue">lowest</font>Â :</td>
<td>-2.370133</td>
<td>-2.353927</td>
<td>-2.307554</td>
<td>-2.221775</td>
<td>-2.155411</td>
</tr>
<tr>
<td>
<font color="MidnightBlue">highest</font>:</td>
<td> 1.481190</td>
<td> 1.589007</td>
<td> 1.796254</td>
<td> 1.806327</td>
<td> 2.267228</td>
</tr>
</table>
<hr class="thinhr">
<span style="font-weight:bold">Feature3</span><div style="float: right; text-align: right;"><img src="data:image/png;base64,%0D%0AiVBORw0KGgoAAAANSUhEUgAAAJcAAAANCAMAAACTvAxuAAAACVBMVEUAAADMzMz////1iUV5AAAAoUlEQVQ4jd2VgQqAIAxEb/7/R4e56WklpiOqg9yQms+xI4izAJ8ywU9AfHwqelQxFOPyQPsnVyKwVfUqLoC51sHW3JPMF1fiivkzfjzcnyZK+9P0C9ffDvbrDpdGO9eGCbWIS4dtgu1zXFzPchpwS1qoE2UfHPzQ8S6oC/Ryc/uh87tsoWR8taAbTJC28h/NTJQMlSVVmFUxrORUj5KWYA8b4U0KZzRGFTwAAAAASUVORK5CYII=" alt="image"></div> <pre style="font-size:85%;">
        n  missing distinct     Info     Mean      Gmd      .05      .10      .25 
      185       15      185        1  0.09474    1.059  -1.6013  -1.2547  -0.4664 
      .50      .75      .90      .95 
   0.2031   0.5606   1.1549   1.7542 
 </pre>
 <style>
 .hmisctable914777 {
 border: none;
 font-size: 85%;
 }
 .hmisctable914777 td {
 text-align: right;
 padding: 0 1ex 0 1ex;
 }
 .hmisctable914777 th {
 color: Black;
 text-align: center;
 padding: 0 1ex 0 1ex;
 font-weight: bold;
 }
 </style>
<table class="table hmisctable914777">
<tr>
<td>
<font color="MidnightBlue">lowest</font>Â :</td>
<td>-2.502358</td>
<td>-2.231959</td>
<td>-1.954812</td>
<td>-1.870602</td>
<td>-1.806355</td>
</tr>
<tr>
<td>
<font color="MidnightBlue">highest</font>:</td>
<td> 2.130775</td>
<td> 2.165554</td>
<td> 2.355507</td>
<td> 2.596700</td>
<td> 2.830719</td>
</tr>
</table>
<hr class="thinhr">
<span style="font-weight:bold">Feature4</span><div style="float: right; text-align: right;"><img src="data:image/png;base64,%0D%0AiVBORw0KGgoAAAANSUhEUgAAAJcAAAANCAMAAACTvAxuAAAACVBMVEUAAADMzMz////1iUV5AAAAm0lEQVQ4jd1VQQ6AIAwr/v/REgfdmBhleIEmCHNgmy0VpAAAGc/ZaeAIAJDRTfQzwxShQ8voKlHRhXlp++jKnNQFhdOFujkocdw72W70o9GlVjRx0tXvfvQNM/VCi8M8uctV7Gv5ltLV/5IlFTa8gBLl9Ca67NZqKLak6VwY7CcnJbz9iuVNe59VQ4mpivHMIgh6lJMSIrkr9QpOF0YKAHhRJqcAAAAASUVORK5CYII=" alt="image"></div> <pre style="font-size:85%;">
        n  missing distinct     Info     Mean      Gmd      .05      .10      .25 
      185       15      185        1  -0.1672    1.154  -1.9226  -1.3864  -0.8397 
      .50      .75      .90      .95 
  -0.1671   0.4562   0.9937   1.4572 
 </pre>
 <style>
 .hmisctable618671 {
 border: none;
 font-size: 85%;
 }
 .hmisctable618671 td {
 text-align: right;
 padding: 0 1ex 0 1ex;
 }
 .hmisctable618671 th {
 color: Black;
 text-align: center;
 padding: 0 1ex 0 1ex;
 font-weight: bold;
 }
 </style>
<table class="table hmisctable618671">
<tr>
<td>
<font color="MidnightBlue">lowest</font>Â :</td>
<td>-3.234216</td>
<td>-2.746084</td>
<td>-2.504351</td>
<td>-2.458920</td>
<td>-2.433345</td>
</tr>
<tr>
<td>
<font color="MidnightBlue">highest</font>:</td>
<td> 1.850866</td>
<td> 2.256517</td>
<td> 2.308067</td>
<td> 2.573330</td>
<td> 3.095538</td>
</tr>
</table>
<hr class="thinhr">
<span style="font-weight:bold">Feature5</span><div style="float: right; text-align: right;"><img src="data:image/png;base64,%0D%0AiVBORw0KGgoAAAANSUhEUgAAAJcAAAANCAMAAACTvAxuAAAACVBMVEUAAADMzMz////1iUV5AAAAoUlEQVQ4jd2TyxKAIAhFr/3/R5ciL2XhGAuLacRogCN2UbIMSCtVq11JBsylgCi6Vu4ljmWIYidx1R368rgttN9whV3Qb0xXz9WSKLLaJkV2BEKe33hT6KHMZdFuzcueuo/C2DAvH1ye12e5HIjpMeJMFn+P/7EpdjAXx0Q0Q4Y08FzmbnaMxcunVTpqpBoR0YxSU72JwpzfMhYvy1m13tYb/28J54Pist4AAAAASUVORK5CYII=" alt="image"></div> <pre style="font-size:85%;">
        n  missing distinct     Info     Mean      Gmd      .05      .10      .25 
      185       15      185        1  0.06659    1.141  -1.6677  -1.3066  -0.4950 
      .50      .75      .90      .95 
   0.1519   0.7312   1.2097   1.5196 
 </pre>
 <style>
 .hmisctable455903 {
 border: none;
 font-size: 85%;
 }
 .hmisctable455903 td {
 text-align: right;
 padding: 0 1ex 0 1ex;
 }
 .hmisctable455903 th {
 color: Black;
 text-align: center;
 padding: 0 1ex 0 1ex;
 font-weight: bold;
 }
 </style>
<table class="table hmisctable455903">
<tr>
<td>
<font color="MidnightBlue">lowest</font>Â :</td>
<td>-3.401910</td>
<td>-3.073375</td>
<td>-2.865278</td>
<td>-2.082252</td>
<td>-2.070115</td>
</tr>
<tr>
<td>
<font color="MidnightBlue">highest</font>:</td>
<td> 2.261810</td>
<td> 2.345893</td>
<td> 2.372141</td>
<td> 2.593233</td>
<td> 2.830696</td>
</tr>
</table>
<hr class="thinhr">
<span style="font-weight:bold">Feature6</span><div style="float: right; text-align: right;"><img src="data:image/png;base64,%0D%0AiVBORw0KGgoAAAANSUhEUgAAAJcAAAANCAMAAACTvAxuAAAACVBMVEUAAADMzMz////1iUV5AAAAoUlEQVQ4je2TWQ6AIAxEh97/0CplmQqESPnQxCYktHR5Ng6CywBf/bixuAzO+nFjZ/nP9az8hVwX041rH+aSnlSFiEaBGCLPo9alD9S1KJfZkwbOEy96Fvf1ca4yMU0lLqQLaoC5Or/hJq48vExkjMZaruRIs1wZE+OWp3uQzh4mOPMM4Vfh/mZ84mUxVVEBWW8Iprn1ejbMCPwauL8Vb7wc6qoK04v+n9QAAAAASUVORK5CYII=" alt="image"></div> <pre style="font-size:85%;">
        n  missing distinct     Info     Mean      Gmd      .05      .10      .25 
      182       18      182        1 -0.03284    1.139 -1.56422 -1.30226 -0.64707 
      .50      .75      .90      .95 
 -0.07747  0.64834  1.24457  1.84808 
 </pre>
 <style>
 .hmisctable504821 {
 border: none;
 font-size: 85%;
 }
 .hmisctable504821 td {
 text-align: right;
 padding: 0 1ex 0 1ex;
 }
 .hmisctable504821 th {
 color: Black;
 text-align: center;
 padding: 0 1ex 0 1ex;
 font-weight: bold;
 }
 </style>
<table class="table hmisctable504821">
<tr>
<td>
<font color="MidnightBlue">lowest</font>Â :</td>
<td>-2.737314</td>
<td>-2.464870</td>
<td>-2.159746</td>
<td>-2.088428</td>
<td>-1.975624</td>
</tr>
<tr>
<td>
<font color="MidnightBlue">highest</font>:</td>
<td> 2.046444</td>
<td> 2.071673</td>
<td> 2.125389</td>
<td> 2.375079</td>
<td> 2.770766</td>
</tr>
</table>
<hr class="thinhr">
<span style="font-weight:bold">Feature7</span><div style="float: right; text-align: right;"><img src="data:image/png;base64,%0D%0AiVBORw0KGgoAAAANSUhEUgAAAJcAAAANCAMAAACTvAxuAAAACVBMVEUAAADMzMz////1iUV5AAAAsUlEQVQ4jd2TURKAIAhEV+9/6BoJWgodZfqo+HCEVnkyLcqDAfSz1atqKhCe89VYM9sgeez1XNwd8FkWqq5zSTMwV7x3oh9xzdlMvNU2aBtYCvOd7EmNvDFnnrS/W8d0DEHXKlw0LrAaPOPFecUcLrtyaX/iUloKhu9cneA6LvD9e1wGd+XCyWUv+zzXTWt/yShuXLFKFdWVTtQAVL4FdoG6ahTFlqFKFcWVivo58morbcoQCh3obqV/AAAAAElFTkSuQmCC" alt="image"></div> <pre style="font-size:85%;">
        n  missing distinct     Info     Mean      Gmd      .05      .10      .25 
      182       18      182        1  -0.1214    1.125  -1.6508  -1.4195  -0.8764 
      .50      .75      .90      .95 
  -0.1013   0.5809   1.0943   1.4524 
 </pre>
 <style>
 .hmisctable735851 {
 border: none;
 font-size: 85%;
 }
 .hmisctable735851 td {
 text-align: right;
 padding: 0 1ex 0 1ex;
 }
 .hmisctable735851 th {
 color: Black;
 text-align: center;
 padding: 0 1ex 0 1ex;
 font-weight: bold;
 }
 </style>
<table class="table hmisctable735851">
<tr>
<td>
<font color="MidnightBlue">lowest</font>Â :</td>
<td>-2.723621</td>
<td>-2.055445</td>
<td>-2.048056</td>
<td>-2.036111</td>
<td>-2.017002</td>
</tr>
<tr>
<td>
<font color="MidnightBlue">highest</font>:</td>
<td> 1.758660</td>
<td> 1.866991</td>
<td> 2.060230</td>
<td> 2.220256</td>
<td> 2.962953</td>
</tr>
</table>
<hr class="thinhr">
<span style="font-weight:bold">Feature8</span><div style="float: right; text-align: right;"><img src="data:image/png;base64,%0D%0AiVBORw0KGgoAAAANSUhEUgAAAJcAAAANCAMAAACTvAxuAAAACVBMVEUAAADMzMz////1iUV5AAAAnklEQVQ4je2V0RKEIAhFj/7/R+9WiEjmkttD03RfEoM8UHcizQtOp4ZLyPPisJjmFmh8XOKfMI91Uy49zJ/1jV+uHpVyrSSOq5LQ5AbR4pbyBlukS2u0NaI6kCY3aMmT89Jme/OSLTMgjLKkScqvg57CZWAoX1JIuV6y8A86vzHXyCO13r6hf1XY9lvaOWOPQPmnbatrlCie9Vvi7pQ+AmYJmMTNzeAAAAAASUVORK5CYII=" alt="image"></div> <pre style="font-size:85%;">
         n   missing  distinct      Info      Mean       Gmd       .05       .10 
       184        16       184         1 -0.002458     1.061 -1.431356 -1.118795 
       .25       .50       .75       .90       .95 
 -0.722701 -0.001633  0.609253  1.127013  1.484123 
 </pre>
 <style>
 .hmisctable174252 {
 border: none;
 font-size: 85%;
 }
 .hmisctable174252 td {
 text-align: right;
 padding: 0 1ex 0 1ex;
 }
 .hmisctable174252 th {
 color: Black;
 text-align: center;
 padding: 0 1ex 0 1ex;
 font-weight: bold;
 }
 </style>
<table class="table hmisctable174252">
<tr>
<td>
<font color="MidnightBlue">lowest</font>Â :</td>
<td>-3.051161</td>
<td>-2.943878</td>
<td>-2.033572</td>
<td>-1.900576</td>
<td>-1.699585</td>
</tr>
<tr>
<td>
<font color="MidnightBlue">highest</font>:</td>
<td> 1.867303</td>
<td> 1.971346</td>
<td> 2.078769</td>
<td> 2.099405</td>
<td> 2.141883</td>
</tr>
</table>
<hr class="thinhr">
<span style="font-weight:bold">Feature9</span><div style="float: right; text-align: right;"><img src="data:image/png;base64,%0D%0AiVBORw0KGgoAAAANSUhEUgAAAJcAAAANCAMAAACTvAxuAAAACVBMVEUAAADMzMz////1iUV5AAAApUlEQVQ4jd1ViwqAMAh0+/+PruZjasLaJHpIIzo7vcQjKOsBkCCPatf1gAx5VDvDfaOuXdTjuiINgkWZH+u6aLzDe0B3jTUUBCKYk5pwgx9pNqDnpubFGL7Tr8wShixVjspzVD6IcUr00fG65sVFBNOgNweFuTjDdsBWnPnm7+kKDDVoOhe8grwSuAdqA5wCzAa/OVfXP88GW5Yc2upJFzGycX8pG5r6CiPa3KA2AAAAAElFTkSuQmCC" alt="image"></div> <pre style="font-size:85%;">
        n  missing distinct     Info     Mean      Gmd      .05      .10      .25 
      180       20      180        1  0.02493    1.126 -1.47971 -1.21517 -0.76473 
      .50      .75      .90      .95 
 -0.05444  0.70497  1.23663  1.80841 
 </pre>
 <style>
 .hmisctable405380 {
 border: none;
 font-size: 85%;
 }
 .hmisctable405380 td {
 text-align: right;
 padding: 0 1ex 0 1ex;
 }
 .hmisctable405380 th {
 color: Black;
 text-align: center;
 padding: 0 1ex 0 1ex;
 font-weight: bold;
 }
 </style>
<table class="table hmisctable405380">
<tr>
<td>
<font color="MidnightBlue">lowest</font>Â :</td>
<td>-2.270617</td>
<td>-1.652102</td>
<td>-1.647208</td>
<td>-1.624930</td>
<td>-1.617549</td>
</tr>
<tr>
<td>
<font color="MidnightBlue">highest</font>:</td>
<td> 2.203612</td>
<td> 2.218559</td>
<td> 2.290920</td>
<td> 2.554994</td>
<td> 3.068365</td>
</tr>
</table>
<hr class="thinhr">
<span style="font-weight:bold">Feature10</span><div style="float: right; text-align: right;"><img src="data:image/png;base64,%0D%0AiVBORw0KGgoAAAANSUhEUgAAAJcAAAANCAMAAACTvAxuAAAACVBMVEUAAADMzMz////1iUV5AAAAu0lEQVQ4jd2T2xKDMAhEN/7/R7cNARYi1tFJxykPuXE7iS7aAgPul9gWGO5X/SMu7Vp3/xHXuw132uFKbiCQRUzfHeE/luucvFhhuqZ5RPQTiMksfqRq0+qaHr+8l7g/u34yuGQW/8rvSNUgDBMXmAuRy/LBiXX30C5dgvL5DZhLV+6quSx24FcPKe7nclm2/xU6xiah4cxQx2FLkXTZ8HmVuOvRVANTkY4NlTWPOzSVZTr1A9MmVPZ9eAGRVwmwCefRbAAAAABJRU5ErkJggg==" alt="image"></div> <pre style="font-size:85%;">
        n  missing distinct     Info     Mean      Gmd      .05      .10      .25 
      184       16      184        1 -0.05658    1.212 -1.90203 -1.35577 -0.86848 
      .50      .75      .90      .95 
  0.01967  0.69126  1.34201  1.53251 
 </pre>
 <style>
 .hmisctable712708 {
 border: none;
 font-size: 85%;
 }
 .hmisctable712708 td {
 text-align: right;
 padding: 0 1ex 0 1ex;
 }
 .hmisctable712708 th {
 color: Black;
 text-align: center;
 padding: 0 1ex 0 1ex;
 font-weight: bold;
 }
 </style>
<table class="table hmisctable712708">
<tr>
<td>
<font color="MidnightBlue">lowest</font>Â :</td>
<td>-2.376023</td>
<td>-2.194766</td>
<td>-2.187092</td>
<td>-2.171611</td>
<td>-2.131747</td>
</tr>
<tr>
<td>
<font color="MidnightBlue">highest</font>:</td>
<td> 2.005846</td>
<td> 2.006810</td>
<td> 2.081642</td>
<td> 2.237558</td>
<td> 2.259483</td>
</tr>
</table>
<hr class="thinhr">
<span style="font-weight:bold">FeatureYN1</span> <style>
 .hmisctable385254 {
 border: none;
 font-size: 85%;
 }
 .hmisctable385254 td {
 text-align: center;
 padding: 0 1ex 0 1ex;
 }
 .hmisctable385254 th {
 color: MidnightBlue;
 text-align: center;
 padding: 0 1ex 0 1ex;
 font-weight: normal;
 }
 </style>
<table class="table hmisctable385254">
<tr>
<th>n</th>
<th>missing</th>
<th>distinct</th>
<th>Info</th>
<th>Sum</th>
<th>Mean</th>
<th>Gmd</th>
</tr>
<tr>
<td>185</td>
<td>15</td>
<td>2</td>
<td>0.749</td>
<td>90</td>
<td>0.4865</td>
<td>0.5024</td>
</tr>
</table>
<hr class="thinhr">
<span style="font-weight:bold">FeatureCategory1</span> <style>
 .hmisctable848410 {
 border: none;
 font-size: 85%;
 }
 .hmisctable848410 td {
 text-align: center;
 padding: 0 1ex 0 1ex;
 }
 .hmisctable848410 th {
 color: MidnightBlue;
 text-align: center;
 padding: 0 1ex 0 1ex;
 font-weight: normal;
 }
 </style>
<table class="table hmisctable848410">
<tr>
<th>n</th>
<th>missing</th>
<th>distinct</th>
</tr>
<tr>
<td>188</td>
<td>12</td>
<td>2</td>
</tr>
</table>
<pre style="font-size:85%;">
 Value          E     F
 Frequency    103    85
 Proportion 0.548 0.452
 </pre>
 <hr class="thinhr">
<span style="font-weight:bold">FeatureCategory2</span><div style="float: right; text-align: right;"><img src="data:image/png;base64,%0D%0AiVBORw0KGgoAAAANSUhEUgAAAA0AAAANCAMAAABFNRROAAAACVBMVEUAAADMzMz////1iUV5AAAAJElEQVQImWNgZGRkYGCEAgYGJiYYRrAgmBQexEwIJt8U3GYCADfaAJQ8QcA8AAAAAElFTkSuQmCC" alt="image"></div> <style>
 .hmisctable293654 {
 border: none;
 font-size: 85%;
 }
 .hmisctable293654 td {
 text-align: center;
 padding: 0 1ex 0 1ex;
 }
 .hmisctable293654 th {
 color: MidnightBlue;
 text-align: center;
 padding: 0 1ex 0 1ex;
 font-weight: normal;
 }
 </style>
<table class="table hmisctable293654">
<tr>
<th>n</th>
<th>missing</th>
<th>distinct</th>
</tr>
<tr>
<td>185</td>
<td>15</td>
<td>4</td>
</tr>
</table>
<pre style="font-size:85%;">
 Value          A     B     C     D
 Frequency     46    52    45    42
 Proportion 0.249 0.281 0.243 0.227
 </pre>
 <hr class="thinhr">
</div>
<div id="missing-value-imputation" class="section level3">
<h3 class="hasAnchor">
<a href="#missing-value-imputation" class="anchor"></a>Missing Value Imputation</h3>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb119-1" title="1">dataImputated &lt;-<span class="st"> </span><span class="kw">aregImpute</span>(<span class="op">~</span>Feature1<span class="op">+</span>Feature2<span class="op">+</span>Feature3<span class="op">+</span></a>
<a class="sourceLine" id="cb119-2" title="2"><span class="st">                </span>Feature4<span class="op">+</span>Feature5<span class="op">+</span>Feature6<span class="op">+</span>Feature7<span class="op">+</span>Feature8<span class="op">+</span>Feature9<span class="op">+</span>Feature10<span class="op">+</span></a>
<a class="sourceLine" id="cb119-3" title="3"><span class="st">                </span>FeatureYN1<span class="op">+</span>FeatureCategory1<span class="op">+</span>FeatureCategory2,</a>
<a class="sourceLine" id="cb119-4" title="4">        <span class="dt">n.impute=</span><span class="dv">10</span>, <span class="dt">data=</span>rawDataWithMissing, <span class="dt">nk=</span><span class="dv">0</span>,<span class="dt">x=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## Iteration 1 
Iteration 2 
Iteration 3 
Iteration 4 
Iteration 5 
Iteration 6 
Iteration 7 
Iteration 8 
Iteration 9 
Iteration 10 
Iteration 11 
Iteration 12 
Iteration 13 </code></pre>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb121-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(dataImputated)</a></code></pre></div>
<pre><code>## 
## Multiple Imputation using Bootstrap and PMM
## 
## aregImpute(formula = ~Feature1 + Feature2 + Feature3 + Feature4 + 
##     Feature5 + Feature6 + Feature7 + Feature8 + Feature9 + Feature10 + 
##     FeatureYN1 + FeatureCategory1 + FeatureCategory2, data = rawDataWithMissing, 
##     n.impute = 10, nk = 0, x = TRUE)
## 
## n: 200   p: 13   Imputations: 10     nk: 0 
## 
## Number of NAs:
##         Feature1         Feature2         Feature3         Feature4         Feature5         Feature6         Feature7         Feature8         Feature9        Feature10       FeatureYN1 FeatureCategory1 FeatureCategory2 
##                9               10               15               15               15               18               18               16               20               16               15               12               15 
## 
##                  type d.f.
## Feature1            l    1
## Feature2            l    1
## Feature3            l    1
## Feature4            l    1
## Feature5            l    1
## Feature6            l    1
## Feature7            l    1
## Feature8            l    1
## Feature9            l    1
## Feature10           l    1
## FeatureYN1          l    1
## FeatureCategory1    c    1
## FeatureCategory2    c    3
## 
## Transformation of Target Variables Forced to be Linear
## 
## R-squares for Predicting Non-Missing Values for Each Variable
## Using Last Imputations of Predictors
##         Feature1         Feature2         Feature3         Feature4         Feature5         Feature6         Feature7         Feature8         Feature9        Feature10       FeatureYN1 FeatureCategory1 FeatureCategory2 
##            0.129            0.160            0.167            0.117            0.091            0.162            0.181            0.104            0.199            0.186            0.101            0.171            0.241</code></pre>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb123-1" title="1"><span class="co">#Values after imputation</span></a>
<a class="sourceLine" id="cb123-2" title="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/names">names</a></span>(dataImputated<span class="op">$</span>imputed)</a></code></pre></div>
<pre><code>##  [1] "Feature1"         "Feature2"         "Feature3"         "Feature4"         "Feature5"         "Feature6"         "Feature7"         "Feature8"         "Feature9"         "Feature10"        "FeatureYN1"       "FeatureCategory1" "FeatureCategory2"</code></pre>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb125-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">tail</a></span>(dataImputated<span class="op">$</span>imputed<span class="op">$</span>Feature1)</a></code></pre></div>
<pre><code>##                  [,1]        [,2]       [,3]       [,4]       [,5]        [,6]        [,7]        [,8]       [,9]       [,10]
## Sample163 -0.33162889  0.02132698  0.2661602  2.6475894 -0.8795306  0.99008049  2.54836955  2.48531123  0.2219203  0.22192028
## Sample170  3.26215759 -0.08590812  0.7682341  1.5976098 -0.4571980  0.02132698 -2.33244368  0.22192028  0.4661118  0.50883214
## Sample176 -0.08693505 -0.87249492 -0.8596109 -2.3458877 -0.1840509  0.02132698 -0.08803881 -0.85961092  0.3114255  0.14210914
## Sample179 -0.77842907 -0.16996848 -0.9063389  0.6047920  1.3086866  1.15930512  0.50883214 -1.19308596 -1.3174246 -0.04139409
## Sample194  2.48531123 -1.31856496  0.7671712 -0.9621342 -0.3159332  0.30981048 -1.47412272 -0.85043444  0.7730934 -1.76084365
## Sample199  0.01963845  0.30981048  0.1421091  1.0146065 -0.1840509 -0.08803881  1.21856764 -0.08693505  0.5088321  0.44182493</code></pre>
</div>
<div id="model-after-missing-value-imputation" class="section level3">
<h3 class="hasAnchor">
<a href="#model-after-missing-value-imputation" class="anchor"></a>Model after Missing Value Imputation</h3>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb127-1" title="1">fmi &lt;-<span class="st"> </span><span class="kw">fit.mult.impute</span>(FeatureYN1<span class="op">~</span>Feature1<span class="op">+</span>Feature2<span class="op">+</span>Feature3<span class="op">+</span>FeatureCategory2,</a>
<a class="sourceLine" id="cb127-2" title="2">        lrm, dataImputated,  </a>
<a class="sourceLine" id="cb127-3" title="3"><span class="co">#       subset=which(rawDataWithMissing$FeatureCategory1=="E"),</span></a>
<a class="sourceLine" id="cb127-4" title="4">        <span class="dt">data=</span>rawDataWithMissing)</a></code></pre></div>
<pre><code>## 
## Variance Inflation Factors Due to Imputation:
## 
##          Intercept           Feature1           Feature2           Feature3 FeatureCategory2=B FeatureCategory2=C FeatureCategory2=D 
##               1.33               1.19               1.21               1.14               1.16               1.32               1.43 
## 
## Rate of Missing Information:
## 
##          Intercept           Feature1           Feature2           Feature3 FeatureCategory2=B FeatureCategory2=C FeatureCategory2=D 
##               0.25               0.16               0.17               0.12               0.14               0.24               0.30 
## 
## d.f. for t-distribution for Tests of Single Coefficients:
## 
##          Intercept           Feature1           Feature2           Feature3 FeatureCategory2=B FeatureCategory2=C FeatureCategory2=D 
##             146.84             343.31             299.38             613.09             453.70             155.44              98.36 
## 
## The following fit components were averaged over the 10 model fits:
## 
##   stats linear.predictors</code></pre>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb129-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(fmi)</a></code></pre></div>
<pre><code>## Logistic Regression Model
##  
##  fit.mult.impute(formula = FeatureYN1 ~ Feature1 + Feature2 + 
##      Feature3 + FeatureCategory2, fitter = lrm, xtrans = dataImputated, 
##      data = rawDataWithMissing)
##  
##                       Model Likelihood     Discrimination    Rank Discrim.    
##                          Ratio Test           Indexes           Indexes       
##  Obs           200    LR chi2      7.68    R2       0.050    C       0.612    
##   0            105    d.f.            6    g        0.453    Dxy     0.223    
##   1             95    Pr(&gt; chi2) 0.3059    gr       1.578    gamma   0.223    
##  max |deriv| 3e-08                         gp       0.110    tau-a   0.112    
##                                            Brier    0.240                     
##  
##                     Coef    S.E.   Wald Z Pr(&gt;|Z|)
##  Intercept           0.0861 0.3362  0.26  0.7978  
##  Feature1            0.2494 0.1496  1.67  0.0955  
##  Feature2           -0.2426 0.1752 -1.38  0.1661  
##  Feature3           -0.0781 0.1641 -0.48  0.6341  
##  FeatureCategory2=B -0.1275 0.4304 -0.30  0.7670  
##  FeatureCategory2=C -0.2298 0.4758 -0.48  0.6290  
##  FeatureCategory2=D -0.3264 0.5077 -0.64  0.5203  
## </code></pre>
<p>##Some notes for Hmisc/rms package</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb131-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(scales)</a>
<a class="sourceLine" id="cb131-2" title="2"><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/rms/topics/Predict">Predict</a></span>(gls1))</a>
<a class="sourceLine" id="cb131-3" title="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(<span class="st">"Exp"</span>)</a>
<a class="sourceLine" id="cb131-4" title="4"></a>
<a class="sourceLine" id="cb131-5" title="5">p&lt;-<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/rms/topics/Predict">Predict</a></span>(gls1),<span class="dt">flipxdiscrete=</span><span class="ot">FALSE</span>,<span class="dt">sepdiscrete=</span><span class="st">"list"</span>,<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/lims.html">ylim</a></span>(<span class="dv">3</span>,<span class="dv">6</span>))</a>
<a class="sourceLine" id="cb131-6" title="6">p[[<span class="dv">1</span>]]</a>
<a class="sourceLine" id="cb131-7" title="7">p[[<span class="dv">1</span>]]<span class="op">+</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span>(<span class="dt">trans=</span><span class="st">"exp"</span>,<span class="dt">limits =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">3</span>,<span class="dv">6</span>))</a>
<a class="sourceLine" id="cb131-8" title="8"></a>
<a class="sourceLine" id="cb131-9" title="9">exp_format &lt;-<span class="st"> </span><span class="cf">function</span>() {</a>
<a class="sourceLine" id="cb131-10" title="10">     <span class="cf">function</span>(x) <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/format">format</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Log">exp</a></span>(x),<span class="dt">digits =</span> <span class="dv">2</span>) </a>
<a class="sourceLine" id="cb131-11" title="11">}</a>
<a class="sourceLine" id="cb131-12" title="12">p[[<span class="dv">1</span>]]<span class="op">+</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span>(<span class="dt">trans=</span><span class="st">"exp"</span>,<span class="dt">limits =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">3</span>,<span class="dv">6</span>),<span class="dt">labels =</span> <span class="kw">exp_format</span>())</a>
<a class="sourceLine" id="cb131-13" title="13">p[[<span class="dv">1</span>]]<span class="op">+</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span>(<span class="dt">labels =</span> <span class="kw">exp_format</span>())</a>
<a class="sourceLine" id="cb131-14" title="14"></a>
<a class="sourceLine" id="cb131-15" title="15"></a>
<a class="sourceLine" id="cb131-16" title="16">p[[<span class="dv">2</span>]]</a>
<a class="sourceLine" id="cb131-17" title="17">p[[<span class="dv">2</span>]]<span class="op">+</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span>(<span class="dt">trans=</span><span class="st">"exp"</span>)</a>
<a class="sourceLine" id="cb131-18" title="18"></a>
<a class="sourceLine" id="cb131-19" title="19"></a>
<a class="sourceLine" id="cb131-20" title="20"><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/rms/topics/Predict">Predict</a></span>(gls1),<span class="dt">flipxdiscrete=</span><span class="ot">FALSE</span>,<span class="dt">addlayer=</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span>(<span class="dt">trans=</span><span class="st">"exp"</span>,<span class="dt">labels=</span><span class="cf">function</span>(x) <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Round">round</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Log">exp</a></span>(x),<span class="dv">2</span>)))</a>
<a class="sourceLine" id="cb131-21" title="21"><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/rms/topics/Predict">Predict</a></span>(gls1),<span class="dt">flipxdiscrete=</span><span class="ot">FALSE</span>)<span class="op">+</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/coord_trans.html">coord_trans</a></span>(<span class="dt">y =</span> <span class="st">"exp"</span>)</a></code></pre></div>
</div>
</div>
<div id="two-way-anova-with-repeated-measures" class="section level2">
<h2 class="hasAnchor">
<a href="#two-way-anova-with-repeated-measures" class="anchor"></a>Two-Way ANOVA with Repeated Measures</h2>
<p><a href="https://biostats.w.uib.no/factorial-repeated-measures-anova-two-way-repeated-measures-anova/" class="uri">https://biostats.w.uib.no/factorial-repeated-measures-anova-two-way-repeated-measures-anova/</a> <a href="http://psych.wisc.edu/moore/Rpdf/610-R9_Within2way.pdf" class="uri">http://psych.wisc.edu/moore/Rpdf/610-R9_Within2way.pdf</a> <a href="https://datascienceplus.com/two-way-anova-with-repeated-measures/" class="uri">https://datascienceplus.com/two-way-anova-with-repeated-measures/</a></p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb132-1" title="1">rat.weight &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">166</span>,<span class="dv">168</span>,<span class="dv">155</span>,<span class="dv">159</span>,<span class="dv">151</span>,<span class="dv">166</span>,<span class="dv">170</span>,<span class="dv">160</span>,<span class="dv">162</span>,<span class="dv">153</span>,<span class="dv">220</span>,<span class="dv">230</span>,<span class="dv">223</span>,<span class="dv">233</span>,<span class="dv">229</span>,<span class="dv">262</span>,<span class="dv">274</span>,<span class="dv">267</span>,<span class="dv">283</span>,<span class="dv">274</span>,<span class="dv">261</span>,<span class="dv">275</span>,<span class="dv">264</span>,<span class="dv">280</span>,<span class="dv">282</span>,<span class="dv">343</span>,<span class="dv">354</span>,<span class="dv">351</span>,<span class="dv">359</span>,<span class="dv">349</span>,<span class="dv">297</span>,<span class="dv">311</span>,<span class="dv">305</span>,<span class="dv">315</span>,<span class="dv">303</span>,<span class="dv">375</span>,<span class="dv">399</span>,<span class="dv">388</span>,<span class="dv">405</span>,<span class="dv">395</span>)</a>
<a class="sourceLine" id="cb132-2" title="2">rat.strain &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">as.factor</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="st">"strainA"</span>,<span class="dv">5</span>),<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="st">"strainB"</span>,<span class="dv">5</span>)),<span class="dv">4</span>))</a>
<a class="sourceLine" id="cb132-3" title="3">rat.ID &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">as.factor</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"rat01"</span>,<span class="st">"rat02"</span>,<span class="st">"rat03"</span>,<span class="st">"rat04"</span>,<span class="st">"rat05"</span>,<span class="st">"rat06"</span>,<span class="st">"rat07"</span>,<span class="st">"rat08"</span>,<span class="st">"rat09"</span>,<span class="st">"rat10"</span>),<span class="dv">4</span>))</a>
<a class="sourceLine" id="cb132-4" title="4">time.point &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">as.factor</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="st">"week08"</span>,<span class="dv">10</span>), <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="st">"week12"</span>,<span class="dv">10</span>), <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="st">"week16"</span>,<span class="dv">10</span>), <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="st">"week20"</span>,<span class="dv">10</span>)))</a>
<a class="sourceLine" id="cb132-5" title="5">my.dataframe &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(rat.ID,rat.strain,time.point,rat.weight)</a>
<a class="sourceLine" id="cb132-6" title="6"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(my.dataframe)</a></code></pre></div>
<pre><code>##   rat.ID rat.strain time.point rat.weight
## 1  rat01    strainA     week08        166
## 2  rat02    strainA     week08        168
## 3  rat03    strainA     week08        155
## 4  rat04    strainA     week08        159
## 5  rat05    strainA     week08        151
## 6  rat06    strainB     week08        166</code></pre>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb134-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/with">with</a></span>(my.dataframe, <span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/interaction.plot">interaction.plot</a></span>(time.point, rat.ID, rat.weight, <span class="dt">pch=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="dv">1</span>,<span class="dv">5</span>), <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="dv">2</span>,<span class="dv">5</span>)), <span class="dt">type=</span><span class="st">"b"</span>, <span class="dt">col=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"black"</span>, <span class="st">"red"</span>, <span class="st">"blue"</span>, <span class="st">"green"</span>, <span class="st">"purple"</span>, <span class="st">"orange"</span>, <span class="st">"grey"</span>, <span class="st">"darkblue"</span>, <span class="st">"pink"</span>, <span class="st">"darkred"</span>), <span class="dt">lty=</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">10</span>)))</a></code></pre></div>
<p><img src="EasierStatisticModels_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb135-1" title="1"><span class="co">#we need to check for normality of distribution with the Shapiro-Wilk test:</span></a>
<a class="sourceLine" id="cb135-2" title="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/shapiro.test">shapiro.test</a></span>(rat.weight[time.point<span class="op">==</span><span class="st">"week08"</span> <span class="op">&amp;</span><span class="st"> </span>rat.strain<span class="op">==</span><span class="st">"strainA"</span>])</a></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  rat.weight[time.point == "week08" &amp; rat.strain == "strainA"]
## W = 0.94153, p-value = 0.6768</code></pre>
<div id="two-way-anova-with-repeated-measures-in-dataset1" class="section level3">
<h3 class="hasAnchor">
<a href="#two-way-anova-with-repeated-measures-in-dataset1" class="anchor"></a>Two-Way ANOVA with Repeated Measures in dataset1</h3>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb137-1" title="1">results &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/aov">aov</a></span>(rat.weight<span class="op">~</span>time.point<span class="op">*</span>rat.strain <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/aov">Error</a></span>(rat.ID<span class="op">/</span>time.point), <span class="dt">data=</span>my.dataframe)</a>
<a class="sourceLine" id="cb137-2" title="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/summary">summary</a></span>(results)</a></code></pre></div>
<pre><code>## 
## Error: rat.ID
##            Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## rat.strain  1  28196   28196   217.5 4.39e-07 ***
## Residuals   8   1037     130                     
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Error: rat.ID:time.point
##                       Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## time.point             3 203193   67731  1750.5  &lt; 2e-16 ***
## time.point:rat.strain  3  10980    3660    94.6 1.96e-13 ***
## Residuals             24    929      39                     
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div id="a-linear-mixed-effects-model-with-nested-random-effects--as-a-validation-" class="section level3">
<h3 class="hasAnchor">
<a href="#a-linear-mixed-effects-model-with-nested-random-effects--as-a-validation-" class="anchor"></a>A linear mixed-effects model with nested random effects. As a validation.</h3>
<p>The F value is the same as Two-Way ANOVA above</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb139-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(nlme)</a>
<a class="sourceLine" id="cb139-2" title="2"></a>
<a class="sourceLine" id="cb139-3" title="3">results.lme &lt;-<span class="st"> </span><span class="kw">lme</span>(rat.weight<span class="op">~</span>time.point<span class="op">*</span>rat.strain, <span class="dt">random=</span><span class="op">~</span><span class="dv">1</span><span class="op">|</span>rat.ID, <span class="dt">data=</span>my.dataframe)</a>
<a class="sourceLine" id="cb139-4" title="4"><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/anova">anova</a></span>(results.lme)</a></code></pre></div>
<pre><code>##                       numDF denDF   F-value p-value
## (Intercept)               1    24 22147.089  &lt;.0001
## time.point                3    24  1750.535  &lt;.0001
## rat.strain                1     8   217.521  &lt;.0001
## time.point:rat.strain     3    24    94.598  &lt;.0001</code></pre>
</div>
<div id="two-way-anova-with-repeated-measures-in-dataset2" class="section level3">
<h3 class="hasAnchor">
<a href="#two-way-anova-with-repeated-measures-in-dataset2" class="anchor"></a>Two-Way ANOVA with Repeated Measures in dataset2</h3>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb141-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Random">set.seed</a></span>(<span class="dv">5250</span>)</a>
<a class="sourceLine" id="cb141-2" title="2"></a>
<a class="sourceLine" id="cb141-3" title="3">myData &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(<span class="dt">PID =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/seq">seq</a></span>(<span class="dt">from =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb141-4" title="4">                               <span class="dt">to =</span> <span class="dv">50</span>, <span class="dt">by =</span> <span class="dv">1</span>), <span class="dv">20</span>),</a>
<a class="sourceLine" id="cb141-5" title="5">                     <span class="dt">stress =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sample">sample</a></span>(<span class="dt">x =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">100</span>,</a>
<a class="sourceLine" id="cb141-6" title="6">                                     <span class="dt">size =</span> <span class="dv">1000</span>,</a>
<a class="sourceLine" id="cb141-7" title="7">                                     <span class="dt">replace =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb141-8" title="8">                     <span class="dt">image =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sample">sample</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"Happy"</span>, <span class="st">"Angry"</span>),</a>
<a class="sourceLine" id="cb141-9" title="9">                                    <span class="dt">size =</span> <span class="dv">1000</span>,</a>
<a class="sourceLine" id="cb141-10" title="10">                                    <span class="dt">replace =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb141-11" title="11">                     <span class="dt">music =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sample">sample</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"Disney"</span>, <span class="st">"Horror"</span>),</a>
<a class="sourceLine" id="cb141-12" title="12">                                    <span class="dt">size =</span> <span class="dv">1000</span>,</a>
<a class="sourceLine" id="cb141-13" title="13">                                    <span class="dt">replace =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb141-14" title="14">)</a>
<a class="sourceLine" id="cb141-15" title="15"></a>
<a class="sourceLine" id="cb141-16" title="16">myData &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/with">within</a></span>(myData, {</a>
<a class="sourceLine" id="cb141-17" title="17">  PID   &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">factor</a></span>(PID)</a>
<a class="sourceLine" id="cb141-18" title="18">  image &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">factor</a></span>(image)</a>
<a class="sourceLine" id="cb141-19" title="19">  music &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">factor</a></span>(music)</a>
<a class="sourceLine" id="cb141-20" title="20">})</a>
<a class="sourceLine" id="cb141-21" title="21"></a>
<a class="sourceLine" id="cb141-22" title="22">myData &lt;-<span class="st"> </span>myData[<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/order">order</a></span>(myData<span class="op">$</span>PID), ]</a>
<a class="sourceLine" id="cb141-23" title="23"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(myData)</a></code></pre></div>
<pre><code>##     PID stress image  music
## 1     1     90 Angry Disney
## 51    1     42 Angry Disney
## 101   1     84 Angry Horror
## 151   1     10 Angry Horror
## 201   1      5 Angry Disney
## 251   1     34 Happy Disney</code></pre>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb143-1" title="1"><span class="co">#Extracting Condition Means</span></a>
<a class="sourceLine" id="cb143-2" title="2">myData.mean &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/aggregate">aggregate</a></span>(myData<span class="op">$</span>stress,</a>
<a class="sourceLine" id="cb143-3" title="3">                      <span class="dt">by =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(myData<span class="op">$</span>PID, myData<span class="op">$</span>music,</a>
<a class="sourceLine" id="cb143-4" title="4">                              myData<span class="op">$</span>image),</a>
<a class="sourceLine" id="cb143-5" title="5">                      <span class="dt">FUN =</span> <span class="st">'mean'</span>)</a>
<a class="sourceLine" id="cb143-6" title="6"></a>
<a class="sourceLine" id="cb143-7" title="7"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/colnames">colnames</a></span>(myData.mean) &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"PID"</span>,<span class="st">"music"</span>,<span class="st">"image"</span>,<span class="st">"stress"</span>)</a>
<a class="sourceLine" id="cb143-8" title="8"></a>
<a class="sourceLine" id="cb143-9" title="9">myData.mean &lt;-<span class="st"> </span>myData.mean[<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/order">order</a></span>(myData.mean<span class="op">$</span>PID), ]</a>
<a class="sourceLine" id="cb143-10" title="10"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(myData.mean)</a></code></pre></div>
<pre><code>##     PID  music image stress
## 1     1 Disney Angry   44.5
## 51    1 Horror Angry   51.5
## 100   1 Disney Happy   49.8
## 149   1 Horror Happy   51.6
## 2     2 Disney Angry   38.5
## 52    2 Horror Angry   28.2</code></pre>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb145-1" title="1"><span class="co">#Building the ANOVA</span></a>
<a class="sourceLine" id="cb145-2" title="2">stress.aov1 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/with">with</a></span>(myData.mean,</a>
<a class="sourceLine" id="cb145-3" title="3">                   <span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/aov">aov</a></span>(stress <span class="op">~</span><span class="st"> </span>music <span class="op">*</span><span class="st"> </span>image <span class="op">+</span></a>
<a class="sourceLine" id="cb145-4" title="4"><span class="st">                       </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/aov">Error</a></span>(PID <span class="op">/</span><span class="st"> </span>(music <span class="op">*</span><span class="st"> </span>image)))</a>
<a class="sourceLine" id="cb145-5" title="5">)</a></code></pre></div>
<pre><code>## Warning in aov(stress ~ music * image + Error(PID/(music * image))): Error() model is singular</code></pre>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb147-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/summary">summary</a></span>(stress.aov1)</a></code></pre></div>
<pre><code>## 
## Error: PID
##             Df Sum Sq Mean Sq F value Pr(&gt;F)  
## music        1    739   739.5   5.171 0.0276 *
## music:image  1    707   706.7   4.942 0.0311 *
## Residuals   47   6721   143.0                 
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Error: PID:music
##             Df Sum Sq Mean Sq F value Pr(&gt;F)
## music        1     13    12.6   0.060  0.808
## image        1    164   163.8   0.774  0.383
## music:image  1    295   295.1   1.395  0.244
## Residuals   47   9943   211.6               
## 
## Error: PID:image
##             Df Sum Sq Mean Sq F value Pr(&gt;F)
## image        1     20   20.18   0.109  0.743
## music:image  1    282  282.10   1.524  0.223
## Residuals   48   8884  185.08               
## 
## Error: PID:music:image
##             Df Sum Sq Mean Sq F value Pr(&gt;F)
## music:image  1     43   43.13   0.214  0.646
## Residuals   47   9457  201.21</code></pre>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb149-1" title="1">stress.aov2 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/with">with</a></span>(myData,</a>
<a class="sourceLine" id="cb149-2" title="2">                   <span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/aov">aov</a></span>(stress <span class="op">~</span><span class="st"> </span>music <span class="op">*</span><span class="st"> </span>image <span class="op">+</span></a>
<a class="sourceLine" id="cb149-3" title="3"><span class="st">                       </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/aov">Error</a></span>(PID <span class="op">/</span><span class="st"> </span>(music <span class="op">*</span><span class="st"> </span>image)))</a>
<a class="sourceLine" id="cb149-4" title="4">)</a></code></pre></div>
<pre><code>## Warning in aov(stress ~ music * image + Error(PID/(music * image))): Error() model is singular</code></pre>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb151-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/summary">summary</a></span>(stress.aov2)</a></code></pre></div>
<pre><code>## 
## Error: PID
##             Df Sum Sq Mean Sq F value  Pr(&gt;F)   
## music        1     33      33   0.056 0.81398   
## image        1    777     777   1.312 0.25795   
## music:image  1   5452    5452   9.211 0.00395 **
## Residuals   46  27229     592                   
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Error: PID:music
##             Df Sum Sq Mean Sq F value Pr(&gt;F)  
## music        1    193     193   0.252 0.6177  
## image        1     37      37   0.049 0.8262  
## music:image  1   3622    3622   4.731 0.0347 *
## Residuals   47  35982     766                 
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Error: PID:image
##             Df Sum Sq Mean Sq F value Pr(&gt;F)
## image        1    297   297.0   0.396  0.532
## music:image  1      5     5.4   0.007  0.933
## Residuals   48  36038   750.8               
## 
## Error: PID:music:image
##             Df Sum Sq Mean Sq F value Pr(&gt;F)
## music:image  1    179   179.1   0.208  0.651
## Residuals   47  40557   862.9               
## 
## Error: Within
##            Df Sum Sq Mean Sq F value Pr(&gt;F)
## Residuals 802 693006   864.1</code></pre>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb153-1" title="1">stress.aov3 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/with">with</a></span>(myData,</a>
<a class="sourceLine" id="cb153-2" title="2">                   <span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/aov">aov</a></span>(stress <span class="op">~</span><span class="st"> </span>music <span class="op">*</span><span class="st"> </span>image <span class="op">+</span></a>
<a class="sourceLine" id="cb153-3" title="3"><span class="st">                       </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/aov">Error</a></span>(PID<span class="op">/</span>music))</a>
<a class="sourceLine" id="cb153-4" title="4">)</a>
<a class="sourceLine" id="cb153-5" title="5"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/summary">summary</a></span>(stress.aov3)</a></code></pre></div>
<pre><code>## 
## Error: PID
##             Df Sum Sq Mean Sq F value  Pr(&gt;F)   
## music        1     33      33   0.056 0.81398   
## image        1    777     777   1.312 0.25795   
## music:image  1   5452    5452   9.211 0.00395 **
## Residuals   46  27229     592                   
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Error: PID:music
##             Df Sum Sq Mean Sq F value Pr(&gt;F)  
## music        1    193     193   0.252 0.6177  
## image        1     37      37   0.049 0.8262  
## music:image  1   3622    3622   4.731 0.0347 *
## Residuals   47  35982     766                 
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Error: Within
##              Df Sum Sq Mean Sq F value Pr(&gt;F)
## image         1    297   297.0   0.347  0.556
## music:image   1    183   183.1   0.214  0.644
## Residuals   898 769602   857.0</code></pre>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb155-1" title="1">stress.aov4 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/aov">aov</a></span>(stress<span class="op">~</span>music <span class="op">*</span><span class="st"> </span>image <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/aov">Error</a></span>(PID<span class="op">/</span>music), <span class="dt">data=</span>myData)</a>
<a class="sourceLine" id="cb155-2" title="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/summary">summary</a></span>(stress.aov4)</a></code></pre></div>
<pre><code>## 
## Error: PID
##             Df Sum Sq Mean Sq F value  Pr(&gt;F)   
## music        1     33      33   0.056 0.81398   
## image        1    777     777   1.312 0.25795   
## music:image  1   5452    5452   9.211 0.00395 **
## Residuals   46  27229     592                   
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Error: PID:music
##             Df Sum Sq Mean Sq F value Pr(&gt;F)  
## music        1    193     193   0.252 0.6177  
## image        1     37      37   0.049 0.8262  
## music:image  1   3622    3622   4.731 0.0347 *
## Residuals   47  35982     766                 
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Error: Within
##              Df Sum Sq Mean Sq F value Pr(&gt;F)
## image         1    297   297.0   0.347  0.556
## music:image   1    183   183.1   0.214  0.644
## Residuals   898 769602   857.0</code></pre>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb157-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(nlme)</a>
<a class="sourceLine" id="cb157-2" title="2">stress.lme0 &lt;-<span class="st"> </span><span class="kw">lme</span>(stress<span class="op">~</span>music<span class="op">*</span>image, <span class="dt">random=</span><span class="op">~</span><span class="dv">1</span><span class="op">|</span>PID, <span class="dt">data=</span>myData.mean)</a>
<a class="sourceLine" id="cb157-3" title="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/anova">anova</a></span>(stress.lme0)</a></code></pre></div>
<pre><code>##             numDF denDF   F-value p-value
## (Intercept)     1   145 2581.7961  &lt;.0001
## music           1   145    0.1370  0.7118
## image           1   145    0.1314  0.7175
## music:image     1   145    0.4198  0.5181</code></pre>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb159-1" title="1">stress.lme1 &lt;-<span class="st"> </span><span class="kw">lme</span>(stress<span class="op">~</span>music<span class="op">*</span>image, <span class="dt">random=</span><span class="op">~</span><span class="dv">1</span><span class="op">|</span>PID, <span class="dt">data=</span>myData)</a>
<a class="sourceLine" id="cb159-2" title="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/anova">anova</a></span>(stress.lme1)</a></code></pre></div>
<pre><code>##             numDF denDF   F-value p-value
## (Intercept)     1   947 2924.4077  &lt;.0001
## music           1   947    0.1798  0.6716
## image           1   947    0.7269  0.3941
## music:image     1   947    0.3023  0.5826</code></pre>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb161-1" title="1">stress.lme2 &lt;-<span class="st"> </span><span class="kw">lme</span>(stress<span class="op">~</span>music<span class="op">*</span>image, <span class="dt">random=</span><span class="op">~</span>image<span class="op">|</span>PID, <span class="dt">data=</span>myData)</a>
<a class="sourceLine" id="cb161-2" title="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/anova">anova</a></span>(stress.lme2)</a></code></pre></div>
<pre><code>##             numDF denDF   F-value p-value
## (Intercept)     1   947 2924.4077  &lt;.0001
## music           1   947    0.1798  0.6716
## image           1   947    0.7269  0.3941
## music:image     1   947    0.3023  0.5826</code></pre>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#functions-and-packages">Functions and packages</a></li>
      <li><a href="#make-data">Make Data</a></li>
      <li><a href="#notes">Notes</a></li>
      <li><a href="#linear-regression">Linear regression</a></li>
      <li><a href="#survival-model">Survival Model</a></li>
      <li><a href="#two-way-anova-with-repeated-measures">Two-Way ANOVA with Repeated Measures</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by The package maintainer.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
